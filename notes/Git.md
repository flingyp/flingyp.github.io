# Git 随记

## git 本地仓库和远程仓库

本地仓库：

存放在本机中的仓库，每台计算机都有本地仓库，本地仓库又可以细分为三个概念，分别是**工作区，暂存区和本地库**。

- 工作区，带.git 文件的文件夹就可以看做是一个工作区，也可以将写代码的地方看成工作区。

- 暂存区，它是一个隐式的概念，工作区中的文件会添加到暂存区。

- 本地库，本地库就是本地仓库中用于存放文件和版本管理的地方，暂存区会将文件提交到本地库当中。

远程仓库：

对于一个团队来说，每个成员都有自己的本地库，那之间怎么进行通信交互呢？就是通过远程仓库来通信交互的（A 将文件推送到远程仓库，B 可以从远程仓库上将 A 推送的文件拉取下来），大名鼎鼎的 github 就是一个远程仓库，中国的 gitee 码云也是一个远程仓库，企业中用的更多的其实是一个被称为 gitlab 的远程仓库。

## 本地仓库中常见操作

1. 初始化工作区 `git init` 将所在目录初始化为工作区

2. 设置签名（需要先设置好我们的签名，用于标识操作人）

> 系统签名的作用域是电脑，设置一次处处生效，项目签名的作用域为当前的工作区，仅在当前工作区有效。（项目签名优先级大于系统签名，如果两者都存在则以项目签名为准）

- 项目签名：设置用户名 :`git config user.name<用户名>` ，设置邮箱号: `git config user.email<邮箱>`

- 系统签名的设置：设置用户名: `git config --global user.name <用户名>` ，设置邮箱号: `git config --global user.email<邮箱>`

3. 添加文件 `git add <文件名>` 将文件添加到暂存区当中

4. 提交文件 `git commit -m '备注信息'` 将文件从暂存区中提交到本地库

## 本地仓库的版本前进 、 后退

对于本地仓库而言，每一次提交的成功执行，就意味着一个新版本的生成，git 会将这些版本给保存起来。

首先需要查看版本详细信息，通过`git reflog` 命令可以查看到所有版本的信息。第一列它会显示一个索引号，这个索引号其实是一个 hash 值，每个版本都会对应一个 hash 值，我们可以通过这个 hash 来进行版本的切换。

- 切换到指定的版本: `git reset --hard 索引号`

## 删除文件的恢复

git 支持文件的恢复操作，不过前提是想要恢复的文件必须之前已经提交到本地仓库当中。

1. `git reset --hard 索引号` 跳转到文件删除前的版本

2. `git restore 文件名` 撤销对这个文件的操作

## 相关分支的操作

- `git branch <分支名>` 创建分支

- `git branch -v` 查看所有分支

- `git checkout <分支名>` 切换分支

- `git checkout -b <分支名>` 创建并切换到新的分支

- `git branch -D <分支名>` 删除分支

- `git merge <分支名>` 合并目标分支到当前分支

## SSH 的配置

1. 先检查下电脑是否配置了用户信息 `git config --global --list`

如果没有配置， 则执行一下命令进行配置

```bash
git config --global  user.name "这里换上你的用户名"
git config --global user.email "这里换上你的邮箱"
```

2. 在本地电脑 通过 git bash 打开执行 `ssh-keygen -t rsa -C "这里换上你的邮箱"`

执行命令后直接回车 3 次即可，不需要去输入密码

3. 可以通过 `cat ~/.ssh/id_rsa.pub` 查看生成的公钥 或者 在电脑的 C 盘/用户文件夹下 找到 .ssh 文件夹 打开可以看到 id_rsa 和 id_rsa.pub 的文件。 id_rsa.pub 是公钥文件

4. 进入自己的 Github 到 Settings 找到 **SSH and GPG keys** 点击 **New SSH key** 按钮。 输入 title 和 公钥 Key 即可。

## 为远程库设置别名

`git remote add <别名> <HTTPS_URL|SSH_URL>`

设置后可以通过 `git push -u 别名 master` 推送（本地当前分支）到远程仓库的 master 分支

## 远程库相关命令

- `git push <别名/地址名> <分支名>` 推送本地库到远程库

- `git clone <别名/地址名>`

- `git pull <别名/远程库地址名> <远程库分支名>` 将远程库新增/修改内容拉取到本地库并合并

- `git fetch <别名/远程库地址名> <远程库分支名>` 将远程库新增/修改内容拉取到本地库

- `git merge <别名/远程分支名>` 将 fetch 下来的内容合并起来

## 查看提交记录

- `git log`

- `git reflog`

## git 忽略文件

1. 在本地仓库中创建 .gitignore 文件并且编辑

```
*.xx：   表示忽略文件名 xx 结尾的文件
! *.xx： 表示git只管理以xx结尾的文件
/files： 表示忽略files文件夹下所有文件
文件名： 表示忽略指定的文件
```

## git 常用命令汇总

> 相关命令的使用 参考[菜鸟教程](https://www.runoob.com/git/git-basic-operations.html)

### 创建仓库命令

- `git init` 初始化仓库

- `git clone` 下载一份项目

### 提交与修改

- `git add` 添加文件仓库

- `git status` 查看本地仓库当前状态

- `git diff` 比较文件的不同，即暂存区 和 工作区的差异

- `git commit` 提交暂存区到本地仓库

- `git reset` 回退版本

- `git rm` 删除工作区文件

- `git mv` 移动或重命名工作区文件

### 提交日志

- `git log` 查看历史提交记录

- `git blame <file>` 以列表形式查看指定文件的历史修改记录

### 远程操作

- `git remote` 远程仓库操作

- `git fetch` 从远程获取代码库

- `git pull` 下载远程代码并且合并

- `git push` 上传远程代码并且合并
