import{_ as s,c as n,o as a,X as l}from"./chunks/framework.12317601.js";const C=JSON.parse('{"title":"Python自动化","description":"","frontmatter":{"title":"Python自动化","tags":["Python"],"categories":["记录学习-成长"]},"headers":[],"relativePath":"services/Python/Python自动化.md","filePath":"services/Python/Python自动化.md"}'),p={name:"services/Python/Python自动化.md"},o=l(`<h2 id="自动化管理电脑文件和文件夹" tabindex="-1">自动化管理电脑文件和文件夹 <a class="header-anchor" href="#自动化管理电脑文件和文件夹" aria-label="Permalink to &quot;自动化管理电脑文件和文件夹&quot;">​</a></h2><h3 id="os-模块和其他模块的方法" tabindex="-1"><code>os</code> 模块和其他模块的方法 <a class="header-anchor" href="#os-模块和其他模块的方法" aria-label="Permalink to &quot;\`os\` 模块和其他模块的方法&quot;">​</a></h3><blockquote><p>提供了处理文件和目录的方法</p></blockquote><p><strong>注意：</strong> 关于路径中的斜杠（/）和反斜杠（\\）</p><ul><li>windows 中采用的是 <strong>反斜杠</strong> 作为文件夹之间的分隔符</li><li>Mac 和 Linux 中采用 <strong>斜杠</strong> 作为文件夹之间的分隔符</li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取当前文件目录</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">getcwd</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 列出当前程序文件夹||指定文件夹下的所有文件和文件夹 返回一个列表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">listdir</span><span style="color:#666666;">((</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 显示当前绝对路径</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">abspath</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># 例子：print(os.path.abspath(&#39;os模块学习.py&#39;))</span></span>
<span class="line"><span style="color:#758575DD;"># E:\\LianXi\\Python自动化学习\\os模块学习.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 返回改路径的父目录</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">dirname</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># # E:\\LianXi\\Python自动化学习</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 把文件夹里的文件夹里的文件都找出来</span></span>
<span class="line"><span style="color:#758575DD;"># dirpath 是文件夹路径 dirnames是dirpath文件夹下的子文件夹列表</span></span>
<span class="line"><span style="color:#758575DD;"># files是dirpath这个文件夹里的文件列表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">walk</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">指定的绝对路径或相对</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 判断是不是文件夹 True是文件夹  False是文件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">isdir</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">要判断的文件</span><span style="color:#CB7676;">/</span><span style="color:#DBD7CAEE;">文件夹的路径</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 如果是文件 则返回 True</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">isfile</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">scandir</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">指定的绝对路径或相对路径</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 显示当前使用的平台 nt 代表 Windows 、posix 代表Linux</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 删除一个文件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">remove</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">filename</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 可生成多层递归目录</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">makedirs</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">dirname/dirname</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 删除单级目录</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">rmdir</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">dirname</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 重命名文件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">remove</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">oldname</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">newname</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 运行 shell命令 注意： 这里是打开一个新的shell，命令结束后会关闭</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">system</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 显示当前平台下的路径分隔符 只有Windows是 \\\\ 其他的是 /</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sep</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 返回改路径的最后一个目录或者文件，如果path以 / 或 \\ 结尾那么就会返回空值</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">basename</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 将 path 分割成路径名或文件名</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">split</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># 例子： print(os.path.split(os.path.abspath(&#39;os模块学习.py&#39;)))</span></span>
<span class="line"><span style="color:#758575DD;"># (&#39;E:\\\\LianXi\\\\Python自动化学习&#39;, &#39;os模块学习.py&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 连接目录和文件名或目录， 返回结果为 path/name</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">join</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> name</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取当前文件目录</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">getcwd</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 列出当前程序文件夹||指定文件夹下的所有文件和文件夹 返回一个列表</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">listdir</span><span style="color:#999999;">((</span><span style="color:#393A34;">path</span><span style="color:#999999;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 显示当前绝对路径</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">abspath</span><span style="color:#999999;">(</span><span style="color:#393A34;">path</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># 例子：print(os.path.abspath(&#39;os模块学习.py&#39;))</span></span>
<span class="line"><span style="color:#A0ADA0;"># E:\\LianXi\\Python自动化学习\\os模块学习.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 返回改路径的父目录</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">dirname</span><span style="color:#999999;">(</span><span style="color:#393A34;">path</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># # E:\\LianXi\\Python自动化学习</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 把文件夹里的文件夹里的文件都找出来</span></span>
<span class="line"><span style="color:#A0ADA0;"># dirpath 是文件夹路径 dirnames是dirpath文件夹下的子文件夹列表</span></span>
<span class="line"><span style="color:#A0ADA0;"># files是dirpath这个文件夹里的文件列表</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">walk</span><span style="color:#999999;">(</span><span style="color:#393A34;">指定的绝对路径或相对</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 判断是不是文件夹 True是文件夹  False是文件</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">isdir</span><span style="color:#999999;">(</span><span style="color:#393A34;">要判断的文件</span><span style="color:#AB5959;">/</span><span style="color:#393A34;">文件夹的路径</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 如果是文件 则返回 True</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">isfile</span><span style="color:#999999;">(</span><span style="color:#393A34;">path</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">scandir</span><span style="color:#999999;">(</span><span style="color:#393A34;">指定的绝对路径或相对路径</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 显示当前使用的平台 nt 代表 Windows 、posix 代表Linux</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 删除一个文件</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">remove</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">filename</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 可生成多层递归目录</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">makedirs</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">dirname/dirname</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 删除单级目录</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">rmdir</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">dirname</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 重命名文件</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">remove</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">oldname</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">newname</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 运行 shell命令 注意： 这里是打开一个新的shell，命令结束后会关闭</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">system</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 显示当前平台下的路径分隔符 只有Windows是 \\\\ 其他的是 /</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">sep</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 返回改路径的最后一个目录或者文件，如果path以 / 或 \\ 结尾那么就会返回空值</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">basename</span><span style="color:#999999;">(</span><span style="color:#393A34;">path</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 将 path 分割成路径名或文件名</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">split</span><span style="color:#999999;">(</span><span style="color:#393A34;">path</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># 例子： print(os.path.split(os.path.abspath(&#39;os模块学习.py&#39;)))</span></span>
<span class="line"><span style="color:#A0ADA0;"># (&#39;E:\\\\LianXi\\\\Python自动化学习&#39;, &#39;os模块学习.py&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 连接目录和文件名或目录， 返回结果为 path/name</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">join</span><span style="color:#999999;">(</span><span style="color:#393A34;">path</span><span style="color:#999999;">,</span><span style="color:#393A34;"> name</span><span style="color:#999999;">)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">判断 文件名以开头或结尾</span></span>
<span class="line"><span style="color:#758575DD;"># 字符串内置方法 .startwith() 和 .endwith()</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">abc.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">startwith</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">ab</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">))</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">abc.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">endwith</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">使用glob模块</span></span>
<span class="line"><span style="color:#758575DD;"># * 匹配所有 ? 匹配任何单个字符 [seq]匹配seq中的任何字符 [!seq]相反</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">glob</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">glob</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">*.py</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">))</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 会查找到当前所有以 .py结尾的文件</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 把文件夹下的文件夹下的文件都找出来！</span></span>
<span class="line"><span style="color:#758575DD;"># 用 ** 表示任何层文件或文件夹</span></span>
<span class="line"><span style="color:#758575DD;"># recursive=True会不断进入文件夹内</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">glob</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">glob</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">**/*.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">recursive</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">匹配文件名 fnmatch 模块</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">fnmatch</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">fnmatch</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">lesson1.py</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">le*1.py</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">))</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">//</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">True</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">判断 文件名以开头或结尾</span></span>
<span class="line"><span style="color:#A0ADA0;"># 字符串内置方法 .startwith() 和 .endwith()</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">abc.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">.</span><span style="color:#393A34;">startwith</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">ab</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">))</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">abc.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">.</span><span style="color:#393A34;">endwith</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">使用glob模块</span></span>
<span class="line"><span style="color:#A0ADA0;"># * 匹配所有 ? 匹配任何单个字符 [seq]匹配seq中的任何字符 [!seq]相反</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">glob</span><span style="color:#999999;">.</span><span style="color:#393A34;">glob</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">*.py</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">))</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 会查找到当前所有以 .py结尾的文件</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 把文件夹下的文件夹下的文件都找出来！</span></span>
<span class="line"><span style="color:#A0ADA0;"># 用 ** 表示任何层文件或文件夹</span></span>
<span class="line"><span style="color:#A0ADA0;"># recursive=True会不断进入文件夹内</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">glob</span><span style="color:#999999;">.</span><span style="color:#393A34;">glob</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">**/*.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">recursive</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">匹配文件名 fnmatch 模块</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">fnmatch</span><span style="color:#999999;">.</span><span style="color:#393A34;">fnmatch</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">lesson1.py</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">le*1.py</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">))</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">//</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">True</span></span></code></pre></div><h3 id="读文件和写文件" tabindex="-1">读文件和写文件 <a class="header-anchor" href="#读文件和写文件" aria-label="Permalink to &quot;读文件和写文件&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># r 读文件</span></span>
<span class="line"><span style="color:#4D9375;">with</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_path</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">utf-8</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">as</span><span style="color:#DBD7CAEE;"> f</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    text </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">readlines</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">text</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># w、 a 写文件</span></span>
<span class="line"><span style="color:#4D9375;">with</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_path</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">w</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">utf-8</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">as</span><span style="color:#DBD7CAEE;"> f</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    text </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">写入内容</span><span style="color:#C99076;">\\n</span><span style="color:#C98A7D;">写入内容</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">text</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">注意：</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	如果存在这个文件 在模式 w 下会清空文件里面的内容写入。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	在模式 a 下会追加在后面写入。</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># r 读文件</span></span>
<span class="line"><span style="color:#1E754F;">with</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_path</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">utf-8</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">as</span><span style="color:#393A34;"> f</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">    text </span><span style="color:#999999;">=</span><span style="color:#393A34;"> f</span><span style="color:#999999;">.</span><span style="color:#393A34;">readlines</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">text</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># w、 a 写文件</span></span>
<span class="line"><span style="color:#1E754F;">with</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_path</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">w</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">utf-8</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">as</span><span style="color:#393A34;"> f</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">    text </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">写入内容</span><span style="color:#A65E2B;">\\n</span><span style="color:#B56959;">写入内容</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    f</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">text</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">注意：</span></span>
<span class="line"><span style="color:#393A34;">	如果存在这个文件 在模式 w 下会清空文件里面的内容写入。</span></span>
<span class="line"><span style="color:#393A34;">	在模式 a 下会追加在后面写入。</span></span></code></pre></div><h3 id="新建、复制、移动、重命名、删除" tabindex="-1">新建、复制、移动、重命名、删除 <a class="header-anchor" href="#新建、复制、移动、重命名、删除" aria-label="Permalink to &quot;新建、复制、移动、重命名、删除&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># 创建</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">mkdir</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">文件夹名称</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 可创建多层递归目录</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">makedirs</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">dirname/dirname</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 判断是否存在</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">exists</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">文件夹名称</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 复制文件 shutil模块</span></span>
<span class="line"><span style="color:#DBD7CAEE;">shutil</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">copy</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">copy_file</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">new_path</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 复制文件夹 shutil 模块</span></span>
<span class="line"><span style="color:#DBD7CAEE;">shutil</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">copytree</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">这是一个文件夹</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">这个一个新的文件夹</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 移动文件或文件夹</span></span>
<span class="line"><span style="color:#DBD7CAEE;">shutil</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">move</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">这是一个新的文件夹/file.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">shutil</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">move</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">这是一个新的文件夹/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 重命名</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">rename</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">new_name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 删除文件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">remove</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 删除文件夹</span></span>
<span class="line"><span style="color:#DBD7CAEE;">shutil</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">rmtree</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">这是文件夹</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># 创建</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">mkdir</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">文件夹名称</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 可创建多层递归目录</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">makedirs</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">dirname/dirname</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 判断是否存在</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">exists</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">文件夹名称</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 复制文件 shutil模块</span></span>
<span class="line"><span style="color:#393A34;">shutil</span><span style="color:#999999;">.</span><span style="color:#393A34;">copy</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">copy_file</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">new_path</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 复制文件夹 shutil 模块</span></span>
<span class="line"><span style="color:#393A34;">shutil</span><span style="color:#999999;">.</span><span style="color:#393A34;">copytree</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">这是一个文件夹</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">这个一个新的文件夹</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 移动文件或文件夹</span></span>
<span class="line"><span style="color:#393A34;">shutil</span><span style="color:#999999;">.</span><span style="color:#393A34;">move</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">这是一个新的文件夹/file.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">shutil</span><span style="color:#999999;">.</span><span style="color:#393A34;">move</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">这是一个新的文件夹/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 重命名</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">rename</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">new_name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 删除文件</span></span>
<span class="line"><span style="color:#393A34;">os</span><span style="color:#999999;">.</span><span style="color:#393A34;">remove</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 删除文件夹</span></span>
<span class="line"><span style="color:#393A34;">shutil</span><span style="color:#999999;">.</span><span style="color:#393A34;">rmtree</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">这是文件夹</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="创建压缩包、解压压缩包" tabindex="-1">创建压缩包、解压压缩包 <a class="header-anchor" href="#创建压缩包、解压压缩包" aria-label="Permalink to &quot;创建压缩包、解压压缩包&quot;">​</a></h3><h3 id="文件出现中文乱码的清空" tabindex="-1">文件出现中文乱码的清空 <a class="header-anchor" href="#文件出现中文乱码的清空" aria-label="Permalink to &quot;文件出现中文乱码的清空&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">建议文件不要用中文，如果有中文可以先获取正确的编码文字，重新重命名</span></span>
<span class="line"><span style="color:#BD976A;">file</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">name</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">encode</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">cp437</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">decode</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">gbk</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">建议文件不要用中文，如果有中文可以先获取正确的编码文字，重新重命名</span></span>
<span class="line"><span style="color:#B07D48;">file</span><span style="color:#999999;">.</span><span style="color:#393A34;">name</span><span style="color:#999999;">.</span><span style="color:#393A34;">encode</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">cp437</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">).</span><span style="color:#393A34;">decode</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">gbk</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span></code></pre></div><h2 id="自动化操作-excel-格式文件" tabindex="-1">自动化操作 Excel 格式文件 <a class="header-anchor" href="#自动化操作-excel-格式文件" aria-label="Permalink to &quot;自动化操作 Excel 格式文件&quot;">​</a></h2><h3 id="xlrd-模块" tabindex="-1">xlrd 模块 <a class="header-anchor" href="#xlrd-模块" aria-label="Permalink to &quot;xlrd 模块&quot;">​</a></h3><h4 id="常用方法" tabindex="-1">常用方法 <a class="header-anchor" href="#常用方法" aria-label="Permalink to &quot;常用方法&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlrd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">open_workbook</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_name_url</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取所有的工资表 返回一个列表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheets</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 取到具体的工作表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheets</span><span style="color:#666666;">()[</span><span style="color:#DBD7CAEE;">number</span><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 根据表的索引获取某个表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheet_by_index</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># 根据表名称去获取某个表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheet_by_name</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Sheet1</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取所有工作表的名称</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheet_names</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 返回excel工作表的数量</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">nsheets</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#393A34;">data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlrd</span><span style="color:#999999;">.</span><span style="color:#393A34;">open_workbook</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_name_url</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取所有的工资表 返回一个列表</span></span>
<span class="line"><span style="color:#393A34;">data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheets</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 取到具体的工作表</span></span>
<span class="line"><span style="color:#393A34;">data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheets</span><span style="color:#999999;">()[</span><span style="color:#393A34;">number</span><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 根据表的索引获取某个表</span></span>
<span class="line"><span style="color:#393A34;">data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheet_by_index</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># 根据表名称去获取某个表</span></span>
<span class="line"><span style="color:#393A34;">data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheet_by_name</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Sheet1</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取所有工作表的名称</span></span>
<span class="line"><span style="color:#393A34;">data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheet_names</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 返回excel工作表的数量</span></span>
<span class="line"><span style="color:#393A34;">data</span><span style="color:#999999;">.</span><span style="color:#393A34;">nsheets</span></span></code></pre></div><h4 id="操作-excel-行" tabindex="-1">操作 excel 行 <a class="header-anchor" href="#操作-excel-行" aria-label="Permalink to &quot;操作 excel 行&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlrd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">open_workbook</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_name_url</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheet_by_index</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 获取第一个工作表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">nrows </span><span style="color:#758575DD;"># 获取表共有多少有效行数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">row</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;">#  获取表中的第二行内容 返回的是列表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">row_types</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 获取指定行中单元格的数据类型</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">row</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">].</span><span style="color:#DBD7CAEE;">value </span><span style="color:#758575DD;"># 获取指定单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">row_values</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 获取第二行（指定行）中所有单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">row_len</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 获取第二行（指定行）的长度</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#393A34;">data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlrd</span><span style="color:#999999;">.</span><span style="color:#393A34;">open_workbook</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_name_url</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet </span><span style="color:#999999;">=</span><span style="color:#393A34;"> data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheet_by_index</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 获取第一个工作表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">nrows </span><span style="color:#A0ADA0;"># 获取表共有多少有效行数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">row</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;">#  获取表中的第二行内容 返回的是列表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">row_types</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 获取指定行中单元格的数据类型</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">row</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">2</span><span style="color:#999999;">].</span><span style="color:#393A34;">value </span><span style="color:#A0ADA0;"># 获取指定单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">row_values</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 获取第二行（指定行）中所有单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">row_len</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 获取第二行（指定行）的长度</span></span></code></pre></div><h4 id="操作-excel-列" tabindex="-1">操作 excel 列 <a class="header-anchor" href="#操作-excel-列" aria-label="Permalink to &quot;操作 excel 列&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlrd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">open_workbook</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_name_url</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheet_by_index</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 获取第一个工作表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">ncols </span><span style="color:#758575DD;"># 获取表共有多少有效列数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">col</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;">#  获取表中的第二列内容 返回的是列表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">col</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">].</span><span style="color:#DBD7CAEE;">value </span><span style="color:#758575DD;"># 获取指定单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">col_types</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 获取指定行中单元格的数据类型 1 表示字符串 2 表示数字</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">col_values</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 获取第二列（指定列）中所有单元格的值 返回的是列表</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#393A34;">data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlrd</span><span style="color:#999999;">.</span><span style="color:#393A34;">open_workbook</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_name_url</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet </span><span style="color:#999999;">=</span><span style="color:#393A34;"> data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheet_by_index</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 获取第一个工作表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">ncols </span><span style="color:#A0ADA0;"># 获取表共有多少有效列数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">col</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;">#  获取表中的第二列内容 返回的是列表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">col</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">2</span><span style="color:#999999;">].</span><span style="color:#393A34;">value </span><span style="color:#A0ADA0;"># 获取指定单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">col_types</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 获取指定行中单元格的数据类型 1 表示字符串 2 表示数字</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">col_values</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 获取第二列（指定列）中所有单元格的值 返回的是列表</span></span></code></pre></div><h4 id="操作-excel-单元格" tabindex="-1">操作 Excel 单元格 <a class="header-anchor" href="#操作-excel-单元格" aria-label="Permalink to &quot;操作 Excel 单元格&quot;">​</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlrd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">open_workbook</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">file_name_url</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheet_by_index</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 获取第一个工作表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 返回指定行指定列的单元格</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">value </span><span style="color:#758575DD;"># 返回指定行指定列的单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell_value</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 返回指定行指定列的单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell_type</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 返回指定行指定列的单元格数据类型</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">ctype  </span><span style="color:#758575DD;"># 返回指定行指定列的单元格数据类型</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xlrd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 读文件 返回的工作簿对象</span></span>
<span class="line"><span style="color:#393A34;">data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlrd</span><span style="color:#999999;">.</span><span style="color:#393A34;">open_workbook</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">file_name_url</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet </span><span style="color:#999999;">=</span><span style="color:#393A34;"> data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheet_by_index</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">)</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 获取第一个工作表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#2F798A;">2</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 返回指定行指定列的单元格</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#2F798A;">2</span><span style="color:#999999;">).</span><span style="color:#393A34;">value </span><span style="color:#A0ADA0;"># 返回指定行指定列的单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell_value</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#2F798A;">2</span><span style="color:#999999;">)</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 返回指定行指定列的单元格的值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell_type</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#2F798A;">2</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 返回指定行指定列的单元格数据类型</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#2F798A;">2</span><span style="color:#999999;">).</span><span style="color:#393A34;">ctype  </span><span style="color:#A0ADA0;"># 返回指定行指定列的单元格数据类型</span></span></code></pre></div><h3 id="xlwt-模块" tabindex="-1">xlwt 模块 <a class="header-anchor" href="#xlwt-模块" aria-label="Permalink to &quot;xlwt 模块&quot;">​</a></h3><ul><li>创建工作簿 - &gt; 创建工资表 -&gt; 填充工作表内容 -&gt; 保存文件</li><li>更多使用方法<a href="https://www.cnblogs.com/python-robot/p/9958352.html" target="_blank" rel="noreferrer">参考文章</a></li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xlwt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 创建工作簿</span></span>
<span class="line"><span style="color:#DBD7CAEE;">wb </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlwt</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Workbook</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 创建工作表</span></span>
<span class="line"><span style="color:#DBD7CAEE;">ws </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> wb</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add_sheet</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">工作表名称</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 填充数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">ws</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write_merge</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">5</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">2019年货币兑换表</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 写入数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">ws</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;">j</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> val</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 插入图片</span></span>
<span class="line"><span style="color:#DBD7CAEE;">ws</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">insert_bitmap</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">xxx.jpg</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> 行</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> 列</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 保存</span></span>
<span class="line"><span style="color:#DBD7CAEE;">wb</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">save</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">xxx.xls</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xlwt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 创建工作簿</span></span>
<span class="line"><span style="color:#393A34;">wb </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlwt</span><span style="color:#999999;">.</span><span style="color:#393A34;">Workbook</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 创建工作表</span></span>
<span class="line"><span style="color:#393A34;">ws </span><span style="color:#999999;">=</span><span style="color:#393A34;"> wb</span><span style="color:#999999;">.</span><span style="color:#393A34;">add_sheet</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">工作表名称</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 填充数据</span></span>
<span class="line"><span style="color:#393A34;">ws</span><span style="color:#999999;">.</span><span style="color:#393A34;">write_merge</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">5</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">2019年货币兑换表</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 写入数据</span></span>
<span class="line"><span style="color:#393A34;">ws</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">i</span><span style="color:#999999;">,</span><span style="color:#393A34;">j</span><span style="color:#999999;">,</span><span style="color:#393A34;"> val</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 插入图片</span></span>
<span class="line"><span style="color:#393A34;">ws</span><span style="color:#999999;">.</span><span style="color:#393A34;">insert_bitmap</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">xxx.jpg</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> 行</span><span style="color:#999999;">,</span><span style="color:#393A34;"> 列</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 保存</span></span>
<span class="line"><span style="color:#393A34;">wb</span><span style="color:#999999;">.</span><span style="color:#393A34;">save</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">xxx.xls</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xlwt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">titlestyle </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlwt</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">XFStyle</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#初始化样式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">titlefont </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlwt</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Font</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">titlefont</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">宋体</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">titlefont</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">bold </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">True</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 加粗</span></span>
<span class="line"><span style="color:#DBD7CAEE;">titlefont</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">height </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">11</span><span style="color:#CB7676;">*</span><span style="color:#4C9A91;">20</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 11 表示字号 20 是衡量单位</span></span>
<span class="line"><span style="color:#DBD7CAEE;">titlefont</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">colour_index </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">0x</span><span style="color:#4C9A91;">08</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#设置字体颜色</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">titlestyle</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">font </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> titlefont</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xlwt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">titlestyle </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlwt</span><span style="color:#999999;">.</span><span style="color:#393A34;">XFStyle</span><span style="color:#999999;">()</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#初始化样式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">titlefont </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlwt</span><span style="color:#999999;">.</span><span style="color:#393A34;">Font</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">titlefont</span><span style="color:#999999;">.</span><span style="color:#393A34;">name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">宋体</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">titlefont</span><span style="color:#999999;">.</span><span style="color:#393A34;">bold </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">True</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 加粗</span></span>
<span class="line"><span style="color:#393A34;">titlefont</span><span style="color:#999999;">.</span><span style="color:#393A34;">height </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">11</span><span style="color:#AB5959;">*</span><span style="color:#2F798A;">20</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 11 表示字号 20 是衡量单位</span></span>
<span class="line"><span style="color:#393A34;">titlefont</span><span style="color:#999999;">.</span><span style="color:#393A34;">colour_index </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">0x</span><span style="color:#2F798A;">08</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#设置字体颜色</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">titlestyle</span><span style="color:#999999;">.</span><span style="color:#393A34;">font </span><span style="color:#999999;">=</span><span style="color:#393A34;"> titlefont</span></span></code></pre></div>`,28),e=[o];function c(t,r,y,A,D,i){return a(),n("div",null,e)}const B=s(p,[["render",c]]);export{C as __pageData,B as default};
