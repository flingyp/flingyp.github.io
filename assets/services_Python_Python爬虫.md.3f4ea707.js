import{_ as s,c as n,o as a,X as l}from"./chunks/framework.12317601.js";const B=JSON.parse('{"title":"Python爬虫","description":"","frontmatter":{"title":"Python爬虫","tags":["Python"],"categories":["记录学习-成长"]},"headers":[],"relativePath":"services/Python/Python爬虫.md","filePath":"services/Python/Python爬虫.md"}'),p={name:"services/Python/Python爬虫.md"},o=l(`<h2 id="数据解析三种方式" tabindex="-1">数据解析三种方式： <a class="header-anchor" href="#数据解析三种方式" aria-label="Permalink to &quot;数据解析三种方式：&quot;">​</a></h2><h3 id="正则" tabindex="-1">正则 <a class="header-anchor" href="#正则" aria-label="Permalink to &quot;正则&quot;">​</a></h3><h3 id="beautifulsoup" tabindex="-1">BeautifulSoup <a class="header-anchor" href="#beautifulsoup" aria-label="Permalink to &quot;BeautifulSoup&quot;">​</a></h3><h4 id="数据解析原理" tabindex="-1">数据解析原理 <a class="header-anchor" href="#数据解析原理" aria-label="Permalink to &quot;数据解析原理&quot;">​</a></h4><ul><li><p>实例化一个 BeautifulSoup 对象，并且将页面源码数据加载到该对象中</p></li><li><p>通过调用 BeautifulSoup 对象中的相关属性或者方法进行标签定位和数据提取</p></li></ul><h4 id="环境安装" tabindex="-1">环境安装 <a class="header-anchor" href="#环境安装" aria-label="Permalink to &quot;环境安装&quot;">​</a></h4><ul><li><p>pip install bs4</p></li><li><p>pip install lxml (一种解析器)</p></li></ul><h4 id="使用方法" tabindex="-1">使用方法 <a class="header-anchor" href="#使用方法" aria-label="Permalink to &quot;使用方法&quot;">​</a></h4><ul><li><p><code>from bs4 import BeautifulSoup</code></p></li><li><p>对象的实例化</p><ul><li>将本地 html 的文档中的数据加载到该对象中</li></ul><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># 本地的 html</span></span>
<span class="line"><span style="color:#DBD7CAEE;">fp </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./xx.html</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">utf-8</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">soup </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> BeautifulSoup</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">fp</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">lxml</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">soup</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># 打印的就是 源码</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># 本地的 html</span></span>
<span class="line"><span style="color:#393A34;">fp </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./xx.html</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">utf-8</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">soup </span><span style="color:#999999;">=</span><span style="color:#393A34;"> BeautifulSoup</span><span style="color:#999999;">(</span><span style="color:#393A34;">fp</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">lxml</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">soup</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># 打印的就是 源码</span></span></code></pre></div><ul><li>将互联网上获取的页面源码加载到该对象中</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">通过 request.text 获取到的 html 源码 放进 BeautifulSoup就可以了</span></span>
<span class="line"><span style="color:#dbd7caee;">soup = BeautifulSoup(request.text, &#39;lxml&#39;)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">通过 request.text 获取到的 html 源码 放进 BeautifulSoup就可以了</span></span>
<span class="line"><span style="color:#393a34;">soup = BeautifulSoup(request.text, &#39;lxml&#39;)</span></span></code></pre></div></li><li><p>相关方法和属性</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">soup = BeautifulSoup(request.text, &#39;lxml&#39;)</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">soup.tagName(标签名) 返回的是文档中第一次出现的 tagName对应的标签</span></span>
<span class="line"><span style="color:#dbd7caee;">    例子：  soup.a、 soup.div</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">soup.find(&#39;tagName&#39;) 返回的是文档中第一次出现的 tagName对应的标签</span></span>
<span class="line"><span style="color:#dbd7caee;">    例子： soup.find(&#39;div&#39;)</span></span>
<span class="line"><span style="color:#dbd7caee;">    如果要获取具体的 div, 可以加个参数 可以是 class / id / 其他的属性 后面 一定要有 _。</span></span>
<span class="line"><span style="color:#dbd7caee;">    例子： soup.find(&#39;div&#39;, class_=&#39;xxx&#39;) 会定位到 class类名为 xxx 的div</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">soup.find_all(&#39;tagName&#39;) 和 soup.find(&#39;tagName&#39;) 一样 后面可以接具体 属性参数</span></span>
<span class="line"><span style="color:#dbd7caee;">    例子： soup.find_all(&#39;a&#39;)  返回符合要求的所有标签 （列表）</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">soup.select(&#39;一种选择器(#选择器、 .选择器、、、)&#39;)</span></span>
<span class="line"><span style="color:#dbd7caee;">    例子： soup.select(&#39;.tang&#39;) 返回 类名是 tang的， 返回的是一个列表</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">soup = BeautifulSoup(request.text, &#39;lxml&#39;)</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">soup.tagName(标签名) 返回的是文档中第一次出现的 tagName对应的标签</span></span>
<span class="line"><span style="color:#393a34;">    例子：  soup.a、 soup.div</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">soup.find(&#39;tagName&#39;) 返回的是文档中第一次出现的 tagName对应的标签</span></span>
<span class="line"><span style="color:#393a34;">    例子： soup.find(&#39;div&#39;)</span></span>
<span class="line"><span style="color:#393a34;">    如果要获取具体的 div, 可以加个参数 可以是 class / id / 其他的属性 后面 一定要有 _。</span></span>
<span class="line"><span style="color:#393a34;">    例子： soup.find(&#39;div&#39;, class_=&#39;xxx&#39;) 会定位到 class类名为 xxx 的div</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">soup.find_all(&#39;tagName&#39;) 和 soup.find(&#39;tagName&#39;) 一样 后面可以接具体 属性参数</span></span>
<span class="line"><span style="color:#393a34;">    例子： soup.find_all(&#39;a&#39;)  返回符合要求的所有标签 （列表）</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">soup.select(&#39;一种选择器(#选择器、 .选择器、、、)&#39;)</span></span>
<span class="line"><span style="color:#393a34;">    例子： soup.select(&#39;.tang&#39;) 返回 类名是 tang的， 返回的是一个列表</span></span></code></pre></div></li></ul><ul><li><p>获取标签之间的文本数据</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">例子： soup.p 下面有 属性 方法</span></span>
<span class="line"><span style="color:#dbd7caee;"> soup.p.text/string/get_text()  获取文本数据</span></span>
<span class="line"><span style="color:#dbd7caee;"> 区别：</span></span>
<span class="line"><span style="color:#dbd7caee;">    text/ get_text()  可以获取某一个标签中所有的文本内容</span></span>
<span class="line"><span style="color:#dbd7caee;">    string 只可以获取该标签下面直系的文本内容</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">例子： soup.p 下面有 属性 方法</span></span>
<span class="line"><span style="color:#393a34;"> soup.p.text/string/get_text()  获取文本数据</span></span>
<span class="line"><span style="color:#393a34;"> 区别：</span></span>
<span class="line"><span style="color:#393a34;">    text/ get_text()  可以获取某一个标签中所有的文本内容</span></span>
<span class="line"><span style="color:#393a34;">    string 只可以获取该标签下面直系的文本内容</span></span></code></pre></div></li></ul><ul><li><p>获取标签中的属性值</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">例子：  soup.a</span></span>
<span class="line"><span style="color:#dbd7caee;">    soup.a[&#39;href&#39;] 直接后面接属性名称</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">例子：  soup.a</span></span>
<span class="line"><span style="color:#393a34;">    soup.a[&#39;href&#39;] 直接后面接属性名称</span></span></code></pre></div></li></ul><h3 id="xpath-解析" tabindex="-1">xpath 解析 <a class="header-anchor" href="#xpath-解析" aria-label="Permalink to &quot;xpath 解析&quot;">​</a></h3><blockquote><p>最常用的且最便捷高效的一种解析方式 <a href="https://www.runoob.com/xpath/xpath-syntax.html" target="_blank" rel="noreferrer">语法知识</a></p></blockquote><ul><li><p>xpath 解析原理</p><ul><li><p>1.实例化一个 etree 的对象，且需要将被解析的页面源码数据加载到该对象中</p></li><li><p>2.调用 etree 对象中的 xpath 方法结合 xpath 表达式实现标签定位和内容捕获</p></li></ul></li><li><p>安装 (就需要安装个 lxml)</p><ul><li>pip install lxml</li></ul></li><li><p>实例化一个 etree 对象</p><ul><li><p>本地的 html 文档中的源码加载到 etree 对象中：</p><ul><li>tree.parse(filePath)</li></ul></li><li><p>将互联网上获取的源码加载到 etree 对象中：</p><ul><li>tree.HTML(request.text)</li></ul></li></ul></li><li><p>xpath(&#39;xpath 表达式&#39;)</p><ul><li><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> lxml </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> etree</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 实例化 etree 对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">tree </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> etree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">parse</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">request</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">tree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">xpath表达式</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> lxml </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> etree</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 实例化 etree 对象</span></span>
<span class="line"><span style="color:#393A34;">tree </span><span style="color:#999999;">=</span><span style="color:#393A34;"> etree</span><span style="color:#999999;">.</span><span style="color:#393A34;">parse</span><span style="color:#999999;">(</span><span style="color:#393A34;">request</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">tree</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">xpath表达式</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span></code></pre></div></li><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;"># 常用xpath表达式</span></span>
<span class="line"><span style="color:#dbd7caee;">    属性定位：</span></span>
<span class="line"><span style="color:#dbd7caee;">    # 找到class属性值为song的div标签</span></span>
<span class="line"><span style="color:#dbd7caee;">    //div[@class=&quot;song&quot;]</span></span>
<span class="line"><span style="color:#dbd7caee;">    层级&amp;索引定位：</span></span>
<span class="line"><span style="color:#dbd7caee;">        #找到class属性值为tang的div的直系子标签ul下的第二个子标签li下的直系子标签a</span></span>
<span class="line"><span style="color:#dbd7caee;">        //div[@class=&quot;tang&quot;]/ul/li[2]/a</span></span>
<span class="line"><span style="color:#dbd7caee;">    逻辑运算：</span></span>
<span class="line"><span style="color:#dbd7caee;">        #找到href属性值为空且class属性值为du的a标签</span></span>
<span class="line"><span style="color:#dbd7caee;">        //a[@href=&quot;&quot; and @class=&quot;du&quot;]</span></span>
<span class="line"><span style="color:#dbd7caee;">    模糊匹配：</span></span>
<span class="line"><span style="color:#dbd7caee;">        //div[contains(@class, &quot;ng&quot;)]</span></span>
<span class="line"><span style="color:#dbd7caee;">        //div[starts-with(@class, &quot;ta&quot;)]</span></span>
<span class="line"><span style="color:#dbd7caee;">    取文本：</span></span>
<span class="line"><span style="color:#dbd7caee;">        # /表示获取某个标签下的文本内容</span></span>
<span class="line"><span style="color:#dbd7caee;">        # //表示获取某个标签下的文本内容和所有子标签下的文本内容</span></span>
<span class="line"><span style="color:#dbd7caee;">        //div[@class=&quot;song&quot;]/p[1]/text()</span></span>
<span class="line"><span style="color:#dbd7caee;">        //div[@class=&quot;tang&quot;]//text()</span></span>
<span class="line"><span style="color:#dbd7caee;">    取属性：</span></span>
<span class="line"><span style="color:#dbd7caee;">        //div[@class=&quot;tang&quot;]//li[2]/a/@href</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;"># 常用xpath表达式</span></span>
<span class="line"><span style="color:#393a34;">    属性定位：</span></span>
<span class="line"><span style="color:#393a34;">    # 找到class属性值为song的div标签</span></span>
<span class="line"><span style="color:#393a34;">    //div[@class=&quot;song&quot;]</span></span>
<span class="line"><span style="color:#393a34;">    层级&amp;索引定位：</span></span>
<span class="line"><span style="color:#393a34;">        #找到class属性值为tang的div的直系子标签ul下的第二个子标签li下的直系子标签a</span></span>
<span class="line"><span style="color:#393a34;">        //div[@class=&quot;tang&quot;]/ul/li[2]/a</span></span>
<span class="line"><span style="color:#393a34;">    逻辑运算：</span></span>
<span class="line"><span style="color:#393a34;">        #找到href属性值为空且class属性值为du的a标签</span></span>
<span class="line"><span style="color:#393a34;">        //a[@href=&quot;&quot; and @class=&quot;du&quot;]</span></span>
<span class="line"><span style="color:#393a34;">    模糊匹配：</span></span>
<span class="line"><span style="color:#393a34;">        //div[contains(@class, &quot;ng&quot;)]</span></span>
<span class="line"><span style="color:#393a34;">        //div[starts-with(@class, &quot;ta&quot;)]</span></span>
<span class="line"><span style="color:#393a34;">    取文本：</span></span>
<span class="line"><span style="color:#393a34;">        # /表示获取某个标签下的文本内容</span></span>
<span class="line"><span style="color:#393a34;">        # //表示获取某个标签下的文本内容和所有子标签下的文本内容</span></span>
<span class="line"><span style="color:#393a34;">        //div[@class=&quot;song&quot;]/p[1]/text()</span></span>
<span class="line"><span style="color:#393a34;">        //div[@class=&quot;tang&quot;]//text()</span></span>
<span class="line"><span style="color:#393a34;">    取属性：</span></span>
<span class="line"><span style="color:#393a34;">        //div[@class=&quot;tang&quot;]//li[2]/a/@href</span></span></code></pre></div></li></ul></li></ul><h2 id="使用-request-模块介绍" tabindex="-1">使用 request 模块<a href="https://blog.csdn.net/qq_37616069/article/details/80376776" target="_blank" rel="noreferrer">介绍</a> <a class="header-anchor" href="#使用-request-模块介绍" aria-label="Permalink to &quot;使用 request 模块[介绍](https://blog.csdn.net/qq_37616069/article/details/80376776)&quot;">​</a></h2><p>在使用 request 模块时 出现中文乱码的情况解决方式： <a href="https://blog.csdn.net/qq_17249717/article/details/98472363" target="_blank" rel="noreferrer">对应文章</a></p><ol><li><p>F12 打开网页源码查看网页的编码方式</p></li><li><p>print(request.encoding) 查看 request 的编码方式。 如果不一致就会出现乱码的情况</p></li><li><p>修改 response.encoding 为对应网页的编码。</p></li></ol><h2 id="验证码识别" tabindex="-1">验证码识别 <a class="header-anchor" href="#验证码识别" aria-label="Permalink to &quot;验证码识别&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">在爬虫的时候有可能会遇到验证码的问题。</span></span>
<span class="line"><span style="color:#dbd7caee;">识别验证码的工具： 超级鹰 http://www.chaojiying.com/cases.html</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">在爬虫的时候有可能会遇到验证码的问题。</span></span>
<span class="line"><span style="color:#393a34;">识别验证码的工具： 超级鹰 http://www.chaojiying.com/cases.html</span></span></code></pre></div><h2 id="异步爬虫" tabindex="-1">异步爬虫 <a class="header-anchor" href="#异步爬虫" aria-label="Permalink to &quot;异步爬虫&quot;">​</a></h2><ol><li><p>目的： 在爬虫中使用异步实现高性能的数据爬取操作</p></li><li><p>异步爬虫的方法</p><ul><li><p>多进程、多线程</p><ul><li>好处： 可以为相关阻塞的操作单独开启线程或者进程， 阻塞操作就可以异步执行</li><li>弊端： 无法无限制的开启多线程或多进程</li></ul></li><li><p>进程池、线程池</p><ul><li>好处： 我们可以降低系统对进程或者线程创建和销毁的频率，从而很好的降低系统的开销</li><li>弊端： 池中线程或进程的数量是有上限的</li></ul></li></ul></li><li><p>线程池的基本使用</p></li></ol><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> time</span></span>
<span class="line"><span style="color:#758575DD;"># 导入线程池模块对应的类</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> multiprocessing</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">dummy </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> Pool</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">sayhello</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">str</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Hello </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#B8A965;">str</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    time</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sleep</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">start </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> time</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">time</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">name_list </span><span style="color:#666666;">=[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">xiaozi</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">aa</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">bb</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">cc</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#758575DD;">#实例化线程池对象，开启了4个线程</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pool </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> Pool</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">4</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pool</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">map</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">sayhello</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;">name_list</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pool</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">close</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pool</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">join</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">end </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> time</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">time</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">end</span><span style="color:#CB7676;">-</span><span style="color:#DBD7CAEE;">start</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 执行结果</span></span>
<span class="line"><span style="color:#758575DD;"># Hello  xiaozi</span></span>
<span class="line"><span style="color:#758575DD;"># Hello  aa</span></span>
<span class="line"><span style="color:#758575DD;"># Hello  bb</span></span>
<span class="line"><span style="color:#758575DD;"># Hello  cc</span></span>
<span class="line"><span style="color:#758575DD;"># 2.0805933475494385</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> time</span></span>
<span class="line"><span style="color:#A0ADA0;"># 导入线程池模块对应的类</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> multiprocessing</span><span style="color:#999999;">.</span><span style="color:#393A34;">dummy </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> Pool</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">sayhello</span><span style="color:#999999;">(</span><span style="color:#393A34;">str</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Hello </span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#998418;">str</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    time</span><span style="color:#999999;">.</span><span style="color:#393A34;">sleep</span><span style="color:#999999;">(</span><span style="color:#2F798A;">2</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">start </span><span style="color:#999999;">=</span><span style="color:#393A34;"> time</span><span style="color:#999999;">.</span><span style="color:#393A34;">time</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">name_list </span><span style="color:#999999;">=[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">xiaozi</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">aa</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">bb</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">cc</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#A0ADA0;">#实例化线程池对象，开启了4个线程</span></span>
<span class="line"><span style="color:#393A34;">pool </span><span style="color:#999999;">=</span><span style="color:#393A34;"> Pool</span><span style="color:#999999;">(</span><span style="color:#2F798A;">4</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">pool</span><span style="color:#999999;">.</span><span style="color:#393A34;">map</span><span style="color:#999999;">(</span><span style="color:#393A34;">sayhello</span><span style="color:#999999;">,</span><span style="color:#393A34;">name_list</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">pool</span><span style="color:#999999;">.</span><span style="color:#393A34;">close</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">pool</span><span style="color:#999999;">.</span><span style="color:#393A34;">join</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">end </span><span style="color:#999999;">=</span><span style="color:#393A34;"> time</span><span style="color:#999999;">.</span><span style="color:#393A34;">time</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">end</span><span style="color:#AB5959;">-</span><span style="color:#393A34;">start</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 执行结果</span></span>
<span class="line"><span style="color:#A0ADA0;"># Hello  xiaozi</span></span>
<span class="line"><span style="color:#A0ADA0;"># Hello  aa</span></span>
<span class="line"><span style="color:#A0ADA0;"># Hello  bb</span></span>
<span class="line"><span style="color:#A0ADA0;"># Hello  cc</span></span>
<span class="line"><span style="color:#A0ADA0;"># 2.0805933475494385</span></span></code></pre></div><ol start="4"><li>单线程 + 异步携程（推荐）</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">从 Python 3.4 开始，Python 中加入了协程的概念，但这个版本的协程还是以生成器对象为基础的，在 Python 3.5 则增加了 async/await，使得协程的实现更加方便。首先我们需要了解下面几个概念：</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">event_loop：事件循环，相当于一个无限循环，我们可以把一些函数注册到这个事件循环上，当满足某些条件的时候，函数就会被循环执行。程序是按照设定的顺序从头执行到尾，运行的次数也是完全按照设定。当在编写异步程序时，必然其中有部分程序的运行耗时是比较久的，需要先让出当前程序的控制权，让其在背后运行，让另一部分的程序先运行起来。当背后运行的程序完成后，也需要及时通知主程序已经完成任务可以进行下一步操作，但这个过程所需的时间是不确定的，需要主程序不断的监听状态，一旦收到了任务完成的消息，就开始进行下一步。loop就是这个持续不断的监视器。</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">coroutine：中文翻译叫协程，在 Python 中常指代为协程对象类型，我们可以将协程对象注册到事件循环中，它会被事件循环调用。我们可以使用 async 关键字来定义一个方法，这个方法在调用时不会立即被执行，而是返回一个协程对象。</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">task：任务，它是对协程对象的进一步封装，包含了任务的各个状态。</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">future：代表将来执行或还没有执行的任务，实际上和 task 没有本质区别。</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">另外我们还需要了解 async/await 关键字，它是从 Python 3.5 才出现的，专门用于定义协程。其中，async 定义一个协程，await 用来挂起阻塞方法的执行。</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">从 Python 3.4 开始，Python 中加入了协程的概念，但这个版本的协程还是以生成器对象为基础的，在 Python 3.5 则增加了 async/await，使得协程的实现更加方便。首先我们需要了解下面几个概念：</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">event_loop：事件循环，相当于一个无限循环，我们可以把一些函数注册到这个事件循环上，当满足某些条件的时候，函数就会被循环执行。程序是按照设定的顺序从头执行到尾，运行的次数也是完全按照设定。当在编写异步程序时，必然其中有部分程序的运行耗时是比较久的，需要先让出当前程序的控制权，让其在背后运行，让另一部分的程序先运行起来。当背后运行的程序完成后，也需要及时通知主程序已经完成任务可以进行下一步操作，但这个过程所需的时间是不确定的，需要主程序不断的监听状态，一旦收到了任务完成的消息，就开始进行下一步。loop就是这个持续不断的监视器。</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">coroutine：中文翻译叫协程，在 Python 中常指代为协程对象类型，我们可以将协程对象注册到事件循环中，它会被事件循环调用。我们可以使用 async 关键字来定义一个方法，这个方法在调用时不会立即被执行，而是返回一个协程对象。</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">task：任务，它是对协程对象的进一步封装，包含了任务的各个状态。</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">future：代表将来执行或还没有执行的任务，实际上和 task 没有本质区别。</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">另外我们还需要了解 async/await 关键字，它是从 Python 3.5 才出现的，专门用于定义协程。其中，async 定义一个协程，await 用来挂起阻塞方法的执行。</span></span></code></pre></div><h2 id="selenium-模块的使用" tabindex="-1">selenium 模块的使用 <a class="header-anchor" href="#selenium-模块的使用" aria-label="Permalink to &quot;selenium 模块的使用&quot;">​</a></h2><blockquote><p>selenium 最初是一个<strong>自动化测试工具</strong>，Selenium 测试直接运行在浏览器中，就像真正的用户在操作一样，而爬虫中使用它主要是为了解决 requests 无法直接执行 JavaScript 代码的问题 selenium 本质是通过驱动浏览器，完全模拟浏览器的操作，比如跳转、输入、点击、下拉等，来拿到网页渲染之后的结果，可支持多种浏览器</p></blockquote><p>在下载使用 selenium 的前提下：</p><ul><li>下载浏览器的驱动程序 (下面网址是谷歌的驱动程序下载地址) <ul><li><a href="http://chromedriver.storage.googleapis.com/index.html" target="_blank" rel="noreferrer">http://chromedriver.storage.googleapis.com/index.html</a></li></ul></li><li>查看驱动和本地浏览器版本的映射关系 <ul><li><a href="http://blog.csdn.net/huilan_same/article/details/51896672" target="_blank" rel="noreferrer">http://blog.csdn.net/huilan_same/article/details/51896672</a></li></ul></li><li>下载好浏览器驱动程序后，再安装 selenium <ul><li>pip install selenium</li></ul></li></ul><h3 id="简单示例" tabindex="-1">简单示例： <a class="header-anchor" href="#简单示例" aria-label="Permalink to &quot;简单示例：&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> selenium inport webriver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 实例化一个浏览器对象 （传入浏览器驱动程序安装对应路径）, r是防止字符转义</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> webdriver</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Chrome</span><span style="color:#666666;">(</span><span style="color:#BD976A;">executable_path</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">驱动程序安装好后的路径)</span></span>
<span class="line"><span style="color:#758575DD;"># 这时候运行这个 python文件就会自动打开浏览器</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 会自动跳转到相应的网址上去</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">一个网页地址</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取该网址的网页的源码, 使用正则、xpath等等来解析数据</span></span>
<span class="line"><span style="color:#BD976A;">page_text</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">page_source</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 关闭浏览器</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">quit</span><span style="color:#666666;">()</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> selenium inport webriver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 实例化一个浏览器对象 （传入浏览器驱动程序安装对应路径）, r是防止字符转义</span></span>
<span class="line"><span style="color:#393A34;">bro </span><span style="color:#999999;">=</span><span style="color:#393A34;"> webdriver</span><span style="color:#999999;">.</span><span style="color:#393A34;">Chrome</span><span style="color:#999999;">(</span><span style="color:#B07D48;">executable_path</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">驱动程序安装好后的路径)</span></span>
<span class="line"><span style="color:#A0ADA0;"># 这时候运行这个 python文件就会自动打开浏览器</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 会自动跳转到相应的网址上去</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">一个网页地址</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取该网址的网页的源码, 使用正则、xpath等等来解析数据</span></span>
<span class="line"><span style="color:#B07D48;">page_text</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">page_source</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 关闭浏览器</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">quit</span><span style="color:#999999;">()</span></span></code></pre></div><h3 id="浏览器驱动目录加入环境变量中的-path" tabindex="-1">浏览器驱动目录加入环境变量中的 Path <a class="header-anchor" href="#浏览器驱动目录加入环境变量中的-path" aria-label="Permalink to &quot;浏览器驱动目录加入环境变量中的 Path&quot;">​</a></h3><p>使用 <code>webdriver.Chrome(executable_path=&#39;驱动程序安装好后的路径)</code>， 我们需要指定浏览器驱动路径。</p><p>如果把浏览器驱动的 <strong>所在目录</strong>加入环境变量 Path 中，以后写 selenium 就不用去指定浏览器驱动路径。直接 <code>wb=webdriver.Chrome()</code> 就可以了。因为，Selenium 会自动在环境变量 Path 指定的那些目录里查找名为 chromedriver.exe 的文件。</p><p>一定要注意的是， 加入环境变量 Path 的，</p><p>不是浏览器驱动全路径，比如 <code>d:\\webdrivers\\chromedriver.exe</code></p><p>而是 浏览器驱动所在目录，比如 <code>d:\\webdrivers</code></p><h3 id="浏览器的创建" tabindex="-1">浏览器的创建 <a class="header-anchor" href="#浏览器的创建" aria-label="Permalink to &quot;浏览器的创建&quot;">​</a></h3><blockquote><p>Selenium 支持非常多的浏览器，如 Chrome、Firefox、Edge 等，还有 Android、BlackBerry 等手机端的浏览器。另外，也支持无界面浏览器 PhantomJS。</p></blockquote><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> selenium </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> webdriver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">bro </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> webdriver</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Chrome</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> webdriver</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Firefox</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> webdriver</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Edge</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> webdriver</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">PhantomJS</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> webdriver</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Safari</span><span style="color:#666666;">()</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> selenium </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> webdriver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">bro </span><span style="color:#999999;">=</span><span style="color:#393A34;"> webdriver</span><span style="color:#999999;">.</span><span style="color:#393A34;">Chrome</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro </span><span style="color:#999999;">=</span><span style="color:#393A34;"> webdriver</span><span style="color:#999999;">.</span><span style="color:#393A34;">Firefox</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro </span><span style="color:#999999;">=</span><span style="color:#393A34;"> webdriver</span><span style="color:#999999;">.</span><span style="color:#393A34;">Edge</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro </span><span style="color:#999999;">=</span><span style="color:#393A34;"> webdriver</span><span style="color:#999999;">.</span><span style="color:#393A34;">PhantomJS</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro </span><span style="color:#999999;">=</span><span style="color:#393A34;"> webdriver</span><span style="color:#999999;">.</span><span style="color:#393A34;">Safari</span><span style="color:#999999;">()</span></span></code></pre></div><h3 id="获取页面源码" tabindex="-1">获取页面源码 <a class="header-anchor" href="#获取页面源码" aria-label="Permalink to &quot;获取页面源码&quot;">​</a></h3><blockquote><p>通过<strong>实例化对象下的 page_source 属性</strong>可以获取网页的源代码， 接着就可以使用解析库（正则、BeautifulSoup、xpath）等来提取数据了。</p></blockquote><h3 id="标签定位" tabindex="-1">标签定位 <a class="header-anchor" href="#标签定位" aria-label="Permalink to &quot;标签定位&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_id</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_name</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_class_name</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_tag_name</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_link_text</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_partial_link_text</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_xpath</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_css_selector</span><span style="color:#666666;">()</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_id</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_name</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_class_name</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_tag_name</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_link_text</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_partial_link_text</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_xpath</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_css_selector</span><span style="color:#999999;">()</span></span></code></pre></div><p>注意：</p><ul><li>find_element_by_xxx 找的是第一个符合条件的标签，find_elements_by_xxx 找的是所有符合条件的标签。</li><li>根据 ID、CSS 选择器和 XPath 获取，它们返回的结果完全一致。</li><li>另外，Selenium 还提供了通用方法<code>find_element()</code>，它需要传入两个参数：查找方式<code>By</code>和值。实际上，它就是<code>find_element_by_id()</code>这种方法的通用函数版本，比如<code>find_element_by_id(id)</code>就等价于<code>find_element(By.ID, id)</code>，二者得到的结果完全一致。</li></ul><h3 id="等待界面元素出现" tabindex="-1">等待界面元素出现 <a class="header-anchor" href="#等待界面元素出现" aria-label="Permalink to &quot;等待界面元素出现&quot;">​</a></h3><p>在我们进行网页操作的时候， 有的元素内容不是可以立即出现的， 可能会等待一段时间。而这个时候如果我们去定位元素而没有定位到元素则有可能会抛出异常。我们这时候就需要等待界面元素的刷新。有两种方法实现：</p><ol><li><p>通过 sleep(x) 去延迟程序的执行</p></li><li><p>Selenium 提供了一个更合理的解决方案：当发现元素没有找到的时候， 并不 立即返回 找不到元素的错误。而是周期性（每隔半秒钟）重新寻找该元素，直到该元素找到，或者超出指定最大等待时长，这时才 抛出异常</p><ol><li>Webdriver 对象上有个方法叫 <strong>implicitly_wait</strong> 接收一个参数，用来指定最大等待时长</li></ol></li></ol><p>例子：<code>wd.implicitly_wait(10)</code></p><p>那么后续所有的 <code>find_element</code> 或者 <code>find_elements</code> 之类的方法调用 都会采用上面的策略：</p><p>如果找不到元素， 每隔 半秒钟 再去界面上查看一次， 直到找到该元素， 或者 过了 10 秒 最大时长。</p><h3 id="标签交互" tabindex="-1">标签交互 <a class="header-anchor" href="#标签交互" aria-label="Permalink to &quot;标签交互&quot;">​</a></h3><blockquote><p>selenium 可以驱动浏览器来执行一些操作，也就是说可以让浏览器执行一些动作。</p><p>进行标签交互的前提是 获取到标签（定位）</p><p>比较常见的有：</p></blockquote><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">假如：</span></span>
<span class="line"><span style="color:#758575DD;"># 获取到一个 id为 q 的输入框</span></span>
<span class="line"><span style="color:#B8A965;">input</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> bro</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find_element_by_id</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">q</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">输入文字</span></span>
<span class="line"><span style="color:#B8A965;">input</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">send_keys</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">输入的内容</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">清空文字</span></span>
<span class="line"><span style="color:#B8A965;">input</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">clear</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">点击按钮</span></span>
<span class="line"><span style="color:#DBD7CAEE;">button</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">click</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">获取元素文本内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">element</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">获取元素属性</span></span>
<span class="line"><span style="color:#DBD7CAEE;">element</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get_attribute</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">属性名</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">获取整个元素对应的HTML文本内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">element</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get_attribute</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">outerHTML</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">只是想获取某个元素 内部 的HTML文本内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">element</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get_attribute</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">innerHTML</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">假如：</span></span>
<span class="line"><span style="color:#A0ADA0;"># 获取到一个 id为 q 的输入框</span></span>
<span class="line"><span style="color:#998418;">input</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> bro</span><span style="color:#999999;">.</span><span style="color:#393A34;">find_element_by_id</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">q</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">输入文字</span></span>
<span class="line"><span style="color:#998418;">input</span><span style="color:#999999;">.</span><span style="color:#393A34;">send_keys</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">输入的内容</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">清空文字</span></span>
<span class="line"><span style="color:#998418;">input</span><span style="color:#999999;">.</span><span style="color:#393A34;">clear</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">点击按钮</span></span>
<span class="line"><span style="color:#393A34;">button</span><span style="color:#999999;">.</span><span style="color:#393A34;">click</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">获取元素文本内容</span></span>
<span class="line"><span style="color:#393A34;">element</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">获取元素属性</span></span>
<span class="line"><span style="color:#393A34;">element</span><span style="color:#999999;">.</span><span style="color:#393A34;">get_attribute</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">属性名</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">获取整个元素对应的HTML文本内容</span></span>
<span class="line"><span style="color:#393A34;">element</span><span style="color:#999999;">.</span><span style="color:#393A34;">get_attribute</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">outerHTML</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">只是想获取某个元素 内部 的HTML文本内容</span></span>
<span class="line"><span style="color:#393A34;">element</span><span style="color:#999999;">.</span><span style="color:#393A34;">get_attribute</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">innerHTML</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="执行-js-代码" tabindex="-1">执行 JS 代码 <a class="header-anchor" href="#执行-js-代码" aria-label="Permalink to &quot;执行 JS 代码&quot;">​</a></h3><blockquote><p>对于某些操作，Selenium API 并没有提供。比如，下拉进度条，它可以直接模拟运行 JavaScript，此时使用<code>execute_script()</code>方法即可实现，代码如下：</p></blockquote><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># demo</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> selenium </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> webdriver</span></span>
<span class="line"><span style="color:#DBD7CAEE;">browser </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> webdriver</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Chrome</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">browser</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">https://www.jd.com/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">browser</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">execute_script</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">window.scrollTo(0, document.body.scrollHeight)</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">browser</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">execute_script</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">alert(&quot;123&quot;)</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># demo</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> selenium </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> webdriver</span></span>
<span class="line"><span style="color:#393A34;">browser </span><span style="color:#999999;">=</span><span style="color:#393A34;"> webdriver</span><span style="color:#999999;">.</span><span style="color:#393A34;">Chrome</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">browser</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">https://www.jd.com/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">browser</span><span style="color:#999999;">.</span><span style="color:#393A34;">execute_script</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">window.scrollTo(0, document.body.scrollHeight)</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">browser</span><span style="color:#999999;">.</span><span style="color:#393A34;">execute_script</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">alert(&quot;123&quot;)</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="前进和后退、关闭浏览器" tabindex="-1">前进和后退、关闭浏览器 <a class="header-anchor" href="#前进和后退、关闭浏览器" aria-label="Permalink to &quot;前进和后退、关闭浏览器&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">前进</span></span>
<span class="line"><span style="color:#dbd7caee;">bro.forward()</span></span>
<span class="line"><span style="color:#dbd7caee;">后退</span></span>
<span class="line"><span style="color:#dbd7caee;">bro.back()</span></span>
<span class="line"><span style="color:#dbd7caee;">关闭浏览器</span></span>
<span class="line"><span style="color:#dbd7caee;">bro.quit()</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">前进</span></span>
<span class="line"><span style="color:#393a34;">bro.forward()</span></span>
<span class="line"><span style="color:#393a34;">后退</span></span>
<span class="line"><span style="color:#393a34;">bro.back()</span></span>
<span class="line"><span style="color:#393a34;">关闭浏览器</span></span>
<span class="line"><span style="color:#393a34;">bro.quit()</span></span></code></pre></div><h3 id="动作链" tabindex="-1">动作链 <a class="header-anchor" href="#动作链" aria-label="Permalink to &quot;动作链&quot;">​</a></h3><blockquote><p>一些交互动作都是针对某个节点执行的。比如，对于输入框，我们就调用它的输入文字和清空文字方法；对于按钮，就调用它的点击方法。其实，还有另外一些操作，它们没有特定的执行对象，<strong>比如鼠标拖曳、键盘按键等，这些动作用另一种方式来执行，那就是动作链。</strong></p></blockquote><ul><li>selenium 处理 iframe <ul><li>如果想定位的元素存在于 iframe 标签里面中， 则必须使用 <code>bro.switch_to_frame(id)</code> id 为 frame 标记的 id 名字</li></ul></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">动作链（拖动）： from selenium.webdriver import ActionChains</span></span>
<span class="line"><span style="color:#dbd7caee;">实例化一个动作链对象: action = ActionChains(bro)</span></span>
<span class="line"><span style="color:#dbd7caee;">长按且点击操作： click_and_hold(div)</span></span>
<span class="line"><span style="color:#dbd7caee;">移动: move_by_offset(x, y)</span></span>
<span class="line"><span style="color:#dbd7caee;">让动作链立即执行： perform()</span></span>
<span class="line"><span style="color:#dbd7caee;">释放动作链对象: action.release()</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">动作链（拖动）： from selenium.webdriver import ActionChains</span></span>
<span class="line"><span style="color:#393a34;">实例化一个动作链对象: action = ActionChains(bro)</span></span>
<span class="line"><span style="color:#393a34;">长按且点击操作： click_and_hold(div)</span></span>
<span class="line"><span style="color:#393a34;">移动: move_by_offset(x, y)</span></span>
<span class="line"><span style="color:#393a34;">让动作链立即执行： perform()</span></span>
<span class="line"><span style="color:#393a34;">释放动作链对象: action.release()</span></span></code></pre></div><h3 id="切换到新的窗口" tabindex="-1">切换到新的窗口 <a class="header-anchor" href="#切换到新的窗口" aria-label="Permalink to &quot;切换到新的窗口&quot;">​</a></h3><p>在网页上操作的时候，我们经常遇到，点击一个链接 或者 按钮，就会打开一个 <code>新窗口</code> 。</p><p>如果我们用 Selenium 写自动化程序 <strong>在新窗口里面 打开一个新网址</strong>， 并且去自动化操作新窗口里面的元素，会有什么问题呢？</p><p>问题就在于，即使新窗口打开了， 这时候，我们的 WebDriver 对象对应的 还是老窗口，自动化操作也还是在老窗口进行。</p><p>需要使用<strong>Webdriver 对象的 switch_to 属性的 window 方法</strong> <code>wd.switch_to.window(handle)</code></p><p>其中，参数 handle 需要传入什么呢？</p><p>WebDriver 对象有 window_handles 属性，这是一个列表对象， 里面包括了当前浏览器里面<strong>所有的窗口句柄</strong>。</p><p>所谓句柄，大家可以想象成对应网页窗口的一个 ID。 例子：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> handle </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> wd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">window_handles</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 先切换到该窗口</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    wd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">switch_to</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">window</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">handle</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 得到该窗口的标题栏字符串，判断是不是我们要操作的那个窗口</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">Bing</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">in</span><span style="color:#DBD7CAEE;"> wd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">title</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 如果是，那么这时候WebDriver对象就是对应的该该窗口，正好，跳出循环，</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">break</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">for</span><span style="color:#393A34;"> handle </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> wd</span><span style="color:#999999;">.</span><span style="color:#393A34;">window_handles</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 先切换到该窗口</span></span>
<span class="line"><span style="color:#393A34;">    wd</span><span style="color:#999999;">.</span><span style="color:#393A34;">switch_to</span><span style="color:#999999;">.</span><span style="color:#393A34;">window</span><span style="color:#999999;">(</span><span style="color:#393A34;">handle</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 得到该窗口的标题栏字符串，判断是不是我们要操作的那个窗口</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">Bing</span><span style="color:#B5695999;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">in</span><span style="color:#393A34;"> wd</span><span style="color:#999999;">.</span><span style="color:#393A34;">title</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 如果是，那么这时候WebDriver对象就是对应的该该窗口，正好，跳出循环，</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">break</span></span></code></pre></div><p>上面的代码的意思是：</p><ul><li><p>我们依次获取 wd.window_handles 里面的所有 句柄 对象， 并且调用 wd.switch_to.window(handle) 方法，切入到每个窗口，</p></li><li><p>然后检查里面该窗口对象的属性（可以是标题栏，地址栏），判断是不是我们要操作的那个窗口，如果是，就跳出循环。</p></li></ul><p>同样的，如果我们在新窗口 操作结束后， 还要回到原来的窗口，该怎么办？</p><p>我们可以仍然使用上面的方法，依次切入窗口，然后根据 标题栏 之类的属性值判断。</p><p>还有更省事的方法。</p><p>因为我们一开始就在 原来的窗口里面，我们知道 进入新窗口操作完后，还要回来，可以事先 保存该老窗口的 句柄，使用如下方法</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># mainWindow变量保存当前窗口的句柄</span></span>
<span class="line"><span style="color:#DBD7CAEE;">mainWindow </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> wd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">current_window_handle</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># mainWindow变量保存当前窗口的句柄</span></span>
<span class="line"><span style="color:#393A34;">mainWindow </span><span style="color:#999999;">=</span><span style="color:#393A34;"> wd</span><span style="color:#999999;">.</span><span style="color:#393A34;">current_window_handle</span></span></code></pre></div><p>切换到新窗口操作完后，就可以直接像下面这样，将 driver 对应的对象返回到原来的窗口</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;">#通过前面保存的老窗口的句柄，自己切换到老窗口</span></span>
<span class="line"><span style="color:#DBD7CAEE;">wd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">switch_to</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">window</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">mainWindow</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">#通过前面保存的老窗口的句柄，自己切换到老窗口</span></span>
<span class="line"><span style="color:#393A34;">wd</span><span style="color:#999999;">.</span><span style="color:#393A34;">switch_to</span><span style="color:#999999;">.</span><span style="color:#393A34;">window</span><span style="color:#999999;">(</span><span style="color:#393A34;">mainWindow</span><span style="color:#999999;">)</span></span></code></pre></div><h2 id="scrapy-框架" tabindex="-1">scrapy 框架 <a class="header-anchor" href="#scrapy-框架" aria-label="Permalink to &quot;scrapy 框架&quot;">​</a></h2><blockquote><p>纯 python 实现的爬虫框架，用户只需要定制开发几个模块就可以轻松的实现一个爬虫，用来抓取网页内容以及各种图片，非常之方便～</p></blockquote><h3 id="环境安装-1" tabindex="-1">环境安装 <a class="header-anchor" href="#环境安装-1" aria-label="Permalink to &quot;环境安装&quot;">​</a></h3><p>windows 系统安装</p><ul><li><code>pip install wheel</code><ul><li>验证安装</li><li><code>&gt;wheel version</code> -&gt;<code>wheel 0.35.1</code></li></ul></li><li>下载 twisted <a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#twisted" target="_blank" rel="noreferrer">下载地址</a> 查找到对应 自己的 Python 版本 <ul><li>安装 twisted <code>pip install Twisted‑20.3.0‑cp38‑cp38‑win_amd64.whl</code></li></ul></li><li><code>pip install pywin32</code><ul><li><code>Successfully installed pywin32-228</code></li></ul></li><li><code>pip install scrapy</code></li><li>测试： 在终端中输入 scrapy 指令，没有报错就是安装成功 <ul><li><code>Scrapy 2.3.0 - no active project</code></li><li>或者输入 <code>scrapy version</code> 出现上面的版本号 代表安装成功</li></ul></li></ul><p>linux 和 mac 系统安装：</p><ul><li><code>pip install scrapy</code></li></ul><h3 id="scrapy-工作流程" tabindex="-1">scrapy 工作流程 <a class="header-anchor" href="#scrapy-工作流程" aria-label="Permalink to &quot;scrapy 工作流程&quot;">​</a></h3><p><img src="https://img2018.cnblogs.com/i-beta/1761010/201912/1761010-20191215201123248-1684106535.png" alt="流程"></p><p><img src="https://img2018.cnblogs.com/i-beta/1761010/201912/1761010-20191215201102574-1002424750.png" alt=""></p><h3 id="scrapy-使用流程" tabindex="-1">scrapy 使用流程 <a class="header-anchor" href="#scrapy-使用流程" aria-label="Permalink to &quot;scrapy 使用流程&quot;">​</a></h3><ul><li><p>创建工程</p><ul><li><code>scrapy startproject ProName</code></li></ul></li><li><p>进入工程目录</p><ul><li><code>cd ProName</code></li></ul></li><li><p>创建爬虫文件</p><ul><li><code>scrapy genspider spiderName www.xxx.com</code></li></ul></li><li><p>编写相关代码</p></li><li><p>执行工程</p></li><li><p><code>scrapy crawl spiderName</code></p></li><li><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">爬虫文件解析</span></span>
<span class="line"><span style="color:#758575DD;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> scrapy</span></span>
<span class="line"><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA994;">QiubaiSpider</span><span style="color:#666666;">(</span><span style="color:#80A665;">scrapy</span><span style="color:#666666;">.</span><span style="color:#80A665;">Spider</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">qiubai</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#应用名称</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">#允许爬取的域名（如果遇到非该域名的url则爬取不到数据）</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    allowed_domains </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">https://www.qiushibaike.com/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">#起始爬取的url</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    start_urls </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">https://www.qiushibaike.com/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;">#访问起始URL并获取结果后的回调函数，该函数的response参数就是向起始的url发送请求后，获取的响应对象.该函数返回值必须为可迭代对象或者NUll</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">parse</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#获取字符串类型的响应内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">body</span><span style="color:#666666;">)</span><span style="color:#758575DD;">#获取字节类型的相应内容</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">爬虫文件解析</span></span>
<span class="line"><span style="color:#A0ADA0;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> scrapy</span></span>
<span class="line"><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E8F82;">QiubaiSpider</span><span style="color:#999999;">(</span><span style="color:#59873A;">scrapy</span><span style="color:#999999;">.</span><span style="color:#59873A;">Spider</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">qiubai</span><span style="color:#B5695999;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#应用名称</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">#允许爬取的域名（如果遇到非该域名的url则爬取不到数据）</span></span>
<span class="line"><span style="color:#393A34;">    allowed_domains </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">https://www.qiushibaike.com/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">#起始爬取的url</span></span>
<span class="line"><span style="color:#393A34;">    start_urls </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">https://www.qiushibaike.com/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;">#访问起始URL并获取结果后的回调函数，该函数的response参数就是向起始的url发送请求后，获取的响应对象.该函数返回值必须为可迭代对象或者NUll</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">parse</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> response</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">response</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#获取字符串类型的响应内容</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">response</span><span style="color:#999999;">.</span><span style="color:#393A34;">body</span><span style="color:#999999;">)</span><span style="color:#A0ADA0;">#获取字节类型的相应内容</span></span></code></pre></div></li><li><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#DBD7CAEE;">配置文件 settings</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">py 修改</span></span>
<span class="line"><span style="color:#758575DD;">#修改内容及其结果如下：</span></span>
<span class="line"><span style="color:#758575DD;">#19行：</span></span>
<span class="line"><span style="color:#C99076;">USER_AGENT</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#伪装请求载体身份</span></span>
<span class="line"><span style="color:#FDAEB7;font-style:italic;">22行</span><span style="color:#DBD7CAEE;">：</span><span style="color:#C99076;">ROBOTSTXT_OBEY</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">False</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;">#可以忽略或者不遵守robots协议</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393A34;">配置文件 settings</span><span style="color:#999999;">.</span><span style="color:#393A34;">py 修改</span></span>
<span class="line"><span style="color:#A0ADA0;">#修改内容及其结果如下：</span></span>
<span class="line"><span style="color:#A0ADA0;">#19行：</span></span>
<span class="line"><span style="color:#A65E2B;">USER_AGENT</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36</span><span style="color:#B5695999;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#伪装请求载体身份</span></span>
<span class="line"><span style="color:#B31D28;font-style:italic;">22行</span><span style="color:#393A34;">：</span><span style="color:#A65E2B;">ROBOTSTXT_OBEY</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">False</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;">#可以忽略或者不遵守robots协议</span></span></code></pre></div></li></ul><h3 id="scrapy-中的文件" tabindex="-1">scrapy 中的文件 <a class="header-anchor" href="#scrapy-中的文件" aria-label="Permalink to &quot;scrapy 中的文件&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;">## 自己写的 spider 文件</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> scrapy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA994;">FirstSpiderSpider</span><span style="color:#666666;">(</span><span style="color:#80A665;">scrapy</span><span style="color:#666666;">.</span><span style="color:#80A665;">Spider</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">first_spider</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 爬虫名</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    allowed_domains </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">www.xxx.com</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 允许爬取的范围</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    start_urls </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">http://www.xxx.com/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 最开始请求的url的地址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">parse</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 处理 start_urls 地址对应的响应</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C99076;">......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">yield</span><span style="color:#DBD7CAEE;"> item  </span><span style="color:#758575DD;"># spider 爬取的数据传动 pipeline</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 从选择器中提取字符串：</span></span>
<span class="line"><span style="color:#4C9A91;">1</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> extract</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> 返回一个包含有字符串数据的列表</span></span>
<span class="line"><span style="color:#4C9A91;">2</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> extract_first</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> 返回列表中的第一个字符串</span></span>
<span class="line"><span style="color:#758575DD;"># 注意点：</span></span>
<span class="line"><span style="color:#4C9A91;">1</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> spider中的 parse 方法名不能改</span></span>
<span class="line"><span style="color:#4C9A91;">2</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> 需要爬取的url地址必须要属性 allowed_domains 下的链接</span></span>
<span class="line"><span style="color:#4C9A91;">3</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> 返回的是一个含有 selector对象的列表， 所以要用到 extract</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;">、extract_first</span><span style="color:#666666;">()</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">## 自己写的 spider 文件</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> scrapy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E8F82;">FirstSpiderSpider</span><span style="color:#999999;">(</span><span style="color:#59873A;">scrapy</span><span style="color:#999999;">.</span><span style="color:#59873A;">Spider</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">first_spider</span><span style="color:#B5695999;">&#39;</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 爬虫名</span></span>
<span class="line"><span style="color:#393A34;">    allowed_domains </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">www.xxx.com</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 允许爬取的范围</span></span>
<span class="line"><span style="color:#393A34;">    start_urls </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">http://www.xxx.com/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 最开始请求的url的地址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">parse</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> response</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 处理 start_urls 地址对应的响应</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A65E2B;">......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">yield</span><span style="color:#393A34;"> item  </span><span style="color:#A0ADA0;"># spider 爬取的数据传动 pipeline</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 从选择器中提取字符串：</span></span>
<span class="line"><span style="color:#2F798A;">1</span><span style="color:#999999;">.</span><span style="color:#393A34;"> extract</span><span style="color:#999999;">()</span><span style="color:#393A34;"> 返回一个包含有字符串数据的列表</span></span>
<span class="line"><span style="color:#2F798A;">2</span><span style="color:#999999;">.</span><span style="color:#393A34;"> extract_first</span><span style="color:#999999;">()</span><span style="color:#393A34;"> 返回列表中的第一个字符串</span></span>
<span class="line"><span style="color:#A0ADA0;"># 注意点：</span></span>
<span class="line"><span style="color:#2F798A;">1</span><span style="color:#999999;">.</span><span style="color:#393A34;"> spider中的 parse 方法名不能改</span></span>
<span class="line"><span style="color:#2F798A;">2</span><span style="color:#999999;">.</span><span style="color:#393A34;"> 需要爬取的url地址必须要属性 allowed_domains 下的链接</span></span>
<span class="line"><span style="color:#2F798A;">3</span><span style="color:#999999;">.</span><span style="color:#393A34;"> response</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">()</span><span style="color:#393A34;"> 返回的是一个含有 selector对象的列表， 所以要用到 extract</span><span style="color:#999999;">()</span><span style="color:#393A34;">、extract_first</span><span style="color:#999999;">()</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># 使用 pipeline</span></span>
<span class="line"><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA994;">ScrapyDemo01Pipeline</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">open_spider</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> spider</span><span style="color:#666666;">):</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 爬虫开启的时候执行一次</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">close_spider</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> spider</span><span style="color:#666666;">):</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 爬虫关闭的时候执行一次</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">process_item</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> item</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> spider</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> item</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 注意点：</span></span>
<span class="line"><span style="color:#4C9A91;">1</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> 需要在 setting中开启 pipeline</span></span>
<span class="line"><span style="color:#C99076;">ITEM_PIPELINES</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># pipeline的位置                                # 权重，数字越低权重越高</span></span>
<span class="line"><span style="color:#DBD7CAEE;">   </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">scrapy_demo01.pipelines.ScrapyDemo01Pipeline</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">300</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#4C9A91;">2</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> pipeline中的 process_item 方法名不能修改</span></span>
<span class="line"><span style="color:#4C9A91;">3</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> 可以有多个 pipeline</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> 可能会有多个 spider，不同pipeline处理不同item的内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4C9A91;">2</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> 一个pipeline的内容可能要做不同的操作</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># 使用 pipeline</span></span>
<span class="line"><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E8F82;">ScrapyDemo01Pipeline</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">open_spider</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> spider</span><span style="color:#999999;">):</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 爬虫开启的时候执行一次</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">close_spider</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> spider</span><span style="color:#999999;">):</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 爬虫关闭的时候执行一次</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">process_item</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> item</span><span style="color:#999999;">,</span><span style="color:#393A34;"> spider</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> item</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 注意点：</span></span>
<span class="line"><span style="color:#2F798A;">1</span><span style="color:#999999;">.</span><span style="color:#393A34;"> 需要在 setting中开启 pipeline</span></span>
<span class="line"><span style="color:#A65E2B;">ITEM_PIPELINES</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># pipeline的位置                                # 权重，数字越低权重越高</span></span>
<span class="line"><span style="color:#393A34;">   </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">scrapy_demo01.pipelines.ScrapyDemo01Pipeline</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">300</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#2F798A;">2</span><span style="color:#999999;">.</span><span style="color:#393A34;"> pipeline中的 process_item 方法名不能修改</span></span>
<span class="line"><span style="color:#2F798A;">3</span><span style="color:#999999;">.</span><span style="color:#393A34;"> 可以有多个 pipeline</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#2F798A;">1</span><span style="color:#999999;">.</span><span style="color:#393A34;"> 可能会有多个 spider，不同pipeline处理不同item的内容</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F798A;">2</span><span style="color:#999999;">.</span><span style="color:#393A34;"> 一个pipeline的内容可能要做不同的操作</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># 使用 items</span></span>
<span class="line"><span style="color:#758575DD;"># 参考： https://blog.csdn.net/qq_34405401/article/details/104101226</span></span>
<span class="line"><span style="color:#DBD7CAEE;">items介绍： 在items</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">py的函数里定义好我们预先需要的字段，并且引入次py文件的函数后，只能定义好的字段</span></span>
<span class="line"><span style="color:#DBD7CAEE;">item使用：</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> 在itmes</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">py预先定义好使用字段</span></span>
<span class="line"><span style="color:#DBD7CAEE;">items</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">py可以有多个函数，每个函数定义不同爬虫的预先使用字段，而在pipelines处理数据时得判断是哪个函数下的字段</span></span>
<span class="line"><span style="color:#DBD7CAEE;">	</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;"> 在爬虫文件引用该类，注意爬虫文件里出现的字段只能是该类定义好的</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> xxx</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">items </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xxxItem 对应的类</span></span>
<span class="line"><span style="color:#DBD7CAEE;">item </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xxxItem</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;"> 此时的item是对象</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> scrapy</span></span>
<span class="line"><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA994;">ScrapyDemo01Item</span><span style="color:#666666;">(</span><span style="color:#80A665;">scrapy</span><span style="color:#666666;">.</span><span style="color:#80A665;">Item</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># define the fields for your item here like:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 1. 在itmes.py预先定义好使用字段</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> scrapy</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Field</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">pass</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># 使用 items</span></span>
<span class="line"><span style="color:#A0ADA0;"># 参考： https://blog.csdn.net/qq_34405401/article/details/104101226</span></span>
<span class="line"><span style="color:#393A34;">items介绍： 在items</span><span style="color:#999999;">.</span><span style="color:#393A34;">py的函数里定义好我们预先需要的字段，并且引入次py文件的函数后，只能定义好的字段</span></span>
<span class="line"><span style="color:#393A34;">item使用：</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#2F798A;">1</span><span style="color:#999999;">.</span><span style="color:#393A34;"> 在itmes</span><span style="color:#999999;">.</span><span style="color:#393A34;">py预先定义好使用字段</span></span>
<span class="line"><span style="color:#393A34;">items</span><span style="color:#999999;">.</span><span style="color:#393A34;">py可以有多个函数，每个函数定义不同爬虫的预先使用字段，而在pipelines处理数据时得判断是哪个函数下的字段</span></span>
<span class="line"><span style="color:#393A34;">	</span><span style="color:#2F798A;">2</span><span style="color:#999999;">.</span><span style="color:#393A34;"> 在爬虫文件引用该类，注意爬虫文件里出现的字段只能是该类定义好的</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> xxx</span><span style="color:#999999;">.</span><span style="color:#393A34;">items </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xxxItem 对应的类</span></span>
<span class="line"><span style="color:#393A34;">item </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xxxItem</span><span style="color:#999999;">()</span><span style="color:#393A34;"> 此时的item是对象</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> scrapy</span></span>
<span class="line"><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E8F82;">ScrapyDemo01Item</span><span style="color:#999999;">(</span><span style="color:#59873A;">scrapy</span><span style="color:#999999;">.</span><span style="color:#59873A;">Item</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># define the fields for your item here like:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 1. 在itmes.py预先定义好使用字段</span></span>
<span class="line"><span style="color:#393A34;">    name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> scrapy</span><span style="color:#999999;">.</span><span style="color:#393A34;">Field</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">pass</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># setting 介绍</span></span>
<span class="line"><span style="color:#C99076;">BOT_NAME</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">boss</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 项目名</span></span>
<span class="line"><span style="color:#C99076;">SPIDER_MODULES</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">boss.spiders</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 爬虫的位置</span></span>
<span class="line"><span style="color:#C99076;">NEWSPIDER_MODULE</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">boss.spiders</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C99076;">ROBOTSTXT_OBEY</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">False</span><span style="color:#DBD7CAEE;"> 默认为True 遵守robot协议</span></span>
<span class="line"><span style="color:#758575DD;">#CONCURRENT_REQUESTS = 32  设置最大的并发请求</span></span>
<span class="line"><span style="color:#758575DD;">#DOWNLOAD_DELAY = 3 下载延迟</span></span>
<span class="line"><span style="color:#758575DD;">#CONCURRENT_REQUESTS_PER_DOMAIN = 16 每个域名最大请求并发数</span></span>
<span class="line"><span style="color:#758575DD;">#CONCURRENT_REQUESTS_PER_IP = 16  每个IP最大请求并发数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">#COOKIES_ENABLED = False  Cookie开启 默认开启了</span></span>
<span class="line"><span style="color:#758575DD;">#TELNETCONSOLE_ENABLED = False</span></span>
<span class="line"><span style="color:#758575DD;">#DEFAULT_REQUEST_HEADERS = {   默认请求头</span></span>
<span class="line"><span style="color:#758575DD;">#   &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#39;,</span></span>
<span class="line"><span style="color:#758575DD;">#   &#39;Accept-Language&#39;: &#39;en&#39;,</span></span>
<span class="line"><span style="color:#758575DD;">#}</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># setting 介绍</span></span>
<span class="line"><span style="color:#A65E2B;">BOT_NAME</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">boss</span><span style="color:#B5695999;">&#39;</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 项目名</span></span>
<span class="line"><span style="color:#A65E2B;">SPIDER_MODULES</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">boss.spiders</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 爬虫的位置</span></span>
<span class="line"><span style="color:#A65E2B;">NEWSPIDER_MODULE</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">boss.spiders</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A65E2B;">ROBOTSTXT_OBEY</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">False</span><span style="color:#393A34;"> 默认为True 遵守robot协议</span></span>
<span class="line"><span style="color:#A0ADA0;">#CONCURRENT_REQUESTS = 32  设置最大的并发请求</span></span>
<span class="line"><span style="color:#A0ADA0;">#DOWNLOAD_DELAY = 3 下载延迟</span></span>
<span class="line"><span style="color:#A0ADA0;">#CONCURRENT_REQUESTS_PER_DOMAIN = 16 每个域名最大请求并发数</span></span>
<span class="line"><span style="color:#A0ADA0;">#CONCURRENT_REQUESTS_PER_IP = 16  每个IP最大请求并发数</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">#COOKIES_ENABLED = False  Cookie开启 默认开启了</span></span>
<span class="line"><span style="color:#A0ADA0;">#TELNETCONSOLE_ENABLED = False</span></span>
<span class="line"><span style="color:#A0ADA0;">#DEFAULT_REQUEST_HEADERS = {   默认请求头</span></span>
<span class="line"><span style="color:#A0ADA0;">#   &#39;Accept&#39;: &#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#39;,</span></span>
<span class="line"><span style="color:#A0ADA0;">#   &#39;Accept-Language&#39;: &#39;en&#39;,</span></span>
<span class="line"><span style="color:#A0ADA0;">#}</span></span></code></pre></div><h3 id="相关模块" tabindex="-1">相关模块 <a class="header-anchor" href="#相关模块" aria-label="Permalink to &quot;相关模块&quot;">​</a></h3><h4 id="logging-日志模块" tabindex="-1"><a href="https://www.cnblogs.com/zhiliang9408/p/10003796.html" target="_blank" rel="noreferrer">logging 日志模块</a> <a class="header-anchor" href="#logging-日志模块" aria-label="Permalink to &quot;[logging 日志模块](https://www.cnblogs.com/zhiliang9408/p/10003796.html)&quot;">​</a></h4><p>logging 在 scrapy 的使用</p><ul><li><p>在 settings 中设置</p></li><li><p>settings 中设置 LOG_LEVEL = &quot;WARNING&quot; (表示只会显示 WARNING 和 WARNING 以上等级的日志)</p></li><li><p>settings 中设置 LOG_FILE = &quot;./a.log&quot; (表示设置日志保存的位置， 设置后终端不会显示日志内容)</p></li><li><p>在 spider.py 或 pipelines.py 等文件中使用 <code>import logging</code>， 实例化 logger， 使用 logger 输出内容</p><ul><li><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#758575DD;"># 1. 简单的方式使用 logging</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> scrapy</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA994;">Itcast1Spider</span><span style="color:#666666;">(</span><span style="color:#80A665;">scrapy</span><span style="color:#666666;">.</span><span style="color:#80A665;">Spider</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">itcast1</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    allowed_domains </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">itcast.cn</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    start_urls </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">http://itcast.cn/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">parse</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> i </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">10</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item</span><span style="color:#666666;">={}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">come_from</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">]=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">itcast1</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            logging</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">warning</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">item</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#758575DD;"># 2. 实例化 logger 后使用</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> scrapy</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">logger</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">logging</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">getLogger</span><span style="color:#666666;">(</span><span style="color:#B8A965;">__name__</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">logger</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">logging</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">basicConfig</span><span style="color:#666666;">(</span><span style="color:#C99076;">...</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#设置日志输出的样式，格式（可看考别人的格式）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA994;">Itcast2Spider</span><span style="color:#666666;">(</span><span style="color:#80A665;">scrapy</span><span style="color:#666666;">.</span><span style="color:#80A665;">Spider</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">itcast2</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    allowed_domains </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">itcast.cn</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    start_urls </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">http://itcast.cn/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">parse</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> i </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">10</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">come_from</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">itcast1</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            logger</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">warning</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">item</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">yield</span><span style="color:#DBD7CAEE;"> item</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#A0ADA0;"># 1. 简单的方式使用 logging</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> scrapy</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E8F82;">Itcast1Spider</span><span style="color:#999999;">(</span><span style="color:#59873A;">scrapy</span><span style="color:#999999;">.</span><span style="color:#59873A;">Spider</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">itcast1</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    allowed_domains </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">itcast.cn</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    start_urls </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">http://itcast.cn/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">parse</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> response</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> i </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">10</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">            item</span><span style="color:#999999;">={}</span></span>
<span class="line"><span style="color:#393A34;">            item</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">come_from</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">]=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">itcast1</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            logging</span><span style="color:#999999;">.</span><span style="color:#393A34;">warning</span><span style="color:#999999;">(</span><span style="color:#393A34;">item</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">pass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#A0ADA0;"># 2. 实例化 logger 后使用</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> scrapy</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">logger</span><span style="color:#999999;">=</span><span style="color:#393A34;">logging</span><span style="color:#999999;">.</span><span style="color:#393A34;">getLogger</span><span style="color:#999999;">(</span><span style="color:#998418;">__name__</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">logger</span><span style="color:#999999;">=</span><span style="color:#393A34;">logging</span><span style="color:#999999;">.</span><span style="color:#393A34;">basicConfig</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">...</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#设置日志输出的样式，格式（可看考别人的格式）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E8F82;">Itcast2Spider</span><span style="color:#999999;">(</span><span style="color:#59873A;">scrapy</span><span style="color:#999999;">.</span><span style="color:#59873A;">Spider</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">itcast2</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    allowed_domains </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">itcast.cn</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    start_urls </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">http://itcast.cn/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">parse</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> response</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> i </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">10</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">            item </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{}</span></span>
<span class="line"><span style="color:#393A34;">            item</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">come_from</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">itcast1</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">            logger</span><span style="color:#999999;">.</span><span style="color:#393A34;">warning</span><span style="color:#999999;">(</span><span style="color:#393A34;">item</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">yield</span><span style="color:#393A34;"> item</span></span></code></pre></div></li></ul></li></ul><p>logging 在普通 py 文件中使用</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> logging</span></span>
<span class="line"><span style="color:#DBD7CAEE;">logger</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">logging</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">basicConfig</span><span style="color:#666666;">(</span><span style="color:#C99076;">...</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#设置日志输出的样式，格式（可看考别人的格式）</span></span>
<span class="line"><span style="color:#758575DD;">#实例化一个</span></span>
<span class="line"><span style="color:#DBD7CAEE;">logger</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">logging</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">getlogger</span><span style="color:#666666;">(</span><span style="color:#B8A965;">__name__</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;">#在任何py文件中调用Logger即可</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> logging</span></span>
<span class="line"><span style="color:#393A34;">logger</span><span style="color:#999999;">=</span><span style="color:#393A34;">logging</span><span style="color:#999999;">.</span><span style="color:#393A34;">basicConfig</span><span style="color:#999999;">(</span><span style="color:#A65E2B;">...</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#设置日志输出的样式，格式（可看考别人的格式）</span></span>
<span class="line"><span style="color:#A0ADA0;">#实例化一个</span></span>
<span class="line"><span style="color:#393A34;">logger</span><span style="color:#999999;">=</span><span style="color:#393A34;">logging</span><span style="color:#999999;">.</span><span style="color:#393A34;">getlogger</span><span style="color:#999999;">(</span><span style="color:#998418;">__name__</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;">#在任何py文件中调用Logger即可</span></span></code></pre></div><h3 id="scrapy-实现翻页请求数据-了解-scrapy-request" tabindex="-1">scrapy 实现翻页请求数据，了解 scrapy.Request() <a class="header-anchor" href="#scrapy-实现翻页请求数据-了解-scrapy-request" aria-label="Permalink to &quot;scrapy 实现翻页请求数据，了解 scrapy.Request()&quot;">​</a></h3><ul><li><p>关于 scrapy 实现翻页请求数据的文章</p><ul><li><a href="https://www.cnblogs.com/zhiliang9408/p/10004141.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/zhiliang9408/p/10004141.html</a></li><li><a href="https://www.jianshu.com/p/66f6b8819fef" target="_blank" rel="noreferrer">https://www.jianshu.com/p/66f6b8819fef</a></li></ul></li><li><p>可以在 setting 中设置好 User-Agent</p><ul><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span></span></code></pre></div></li></ul></li></ul><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> scrapy</span></span>
<span class="line"><span style="color:#CB7676;">class</span><span style="color:#DBD7CAEE;"> </span><span style="color:#5DA994;">HrSpider</span><span style="color:#666666;">(</span><span style="color:#80A665;">scrapy</span><span style="color:#666666;">.</span><span style="color:#80A665;">Spider</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">Hr</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    allowed_domains </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">tencent.com</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    start_urls </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">https://hr.tencent.com/position.php</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">parse</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">self</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        tr_list</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">//table[@class=&#39;tablelist&#39;]/tr</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">:</span><span style="color:#CB7676;">-</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> tr </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> tr_list</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item</span><span style="color:#666666;">={}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">title</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">]=</span><span style="color:#DBD7CAEE;">tr</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">./td[1]/a/text()</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">extract_first</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">postion</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">]=</span><span style="color:#DBD7CAEE;">tr</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">./td[2]/text()</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">extract_first</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">publish_date</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">]=</span><span style="color:#DBD7CAEE;">tr</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">./td[5]/text()</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">extract_first</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">yield</span><span style="color:#DBD7CAEE;"> item  </span><span style="color:#758575DD;"># 将本页的数据传入 pipeline 进行数据存储</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#758575DD;">#找到下一页的URL地址,实现翻页请求</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            next_url</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">//a[@id=&#39;next&#39;]/@href</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">extract_first</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#758575DD;"># 判断， 指如果是最后一页的话 它的 url地址为 javascript:; 就不需要执行下面的内容了。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> next_url </span><span style="color:#CB7676;">!=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;"> javascript:;</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                next_url</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://hr.tencent.com/</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;">next_url</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#758575DD;"># scrapy.Request能构建一个 requests对象，同时指定提取数据的 callback函数</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#4D9375;">yield</span><span style="color:#DBD7CAEE;"> scrapy</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Request</span><span style="color:#666666;">(</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    next_url</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#758575DD;"># 这里指定的就是 def parse(self, response):本身。</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#758575DD;"># 如果是要提取其他不同数据,要执行其他的函数 也可以在 spider文件中添加其他的爬虫函数</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#BD976A;">callback</span><span style="color:#666666;">=</span><span style="color:#C99076;">self</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">parse</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#758575DD;"># 那么 就需要添加一个 self.parse1 函数来爬取对应的数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                    </span><span style="color:#758575DD;"># callback = self.parse1</span></span>
<span class="line"><span style="color:#DBD7CAEE;">                </span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># -*- coding: utf-8 -*-</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> scrapy</span></span>
<span class="line"><span style="color:#AB5959;">class</span><span style="color:#393A34;"> </span><span style="color:#2E8F82;">HrSpider</span><span style="color:#999999;">(</span><span style="color:#59873A;">scrapy</span><span style="color:#999999;">.</span><span style="color:#59873A;">Spider</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">Hr</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    allowed_domains </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">tencent.com</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    start_urls </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">https://hr.tencent.com/position.php</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">parse</span><span style="color:#999999;">(</span><span style="color:#393A34;">self</span><span style="color:#999999;">,</span><span style="color:#393A34;"> response</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        tr_list</span><span style="color:#999999;">=</span><span style="color:#393A34;">response</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">//table[@class=&#39;tablelist&#39;]/tr</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">1</span><span style="color:#999999;">:</span><span style="color:#AB5959;">-</span><span style="color:#2F798A;">1</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> tr </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> tr_list</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            item</span><span style="color:#999999;">={}</span></span>
<span class="line"><span style="color:#393A34;">            item</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">title</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">]=</span><span style="color:#393A34;">tr</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">./td[1]/a/text()</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">).</span><span style="color:#393A34;">extract_first</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">            item</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">postion</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">]=</span><span style="color:#393A34;">tr</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">./td[2]/text()</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">).</span><span style="color:#393A34;">extract_first</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">            item</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">publish_date</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">]=</span><span style="color:#393A34;">tr</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">./td[5]/text()</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">).</span><span style="color:#393A34;">extract_first</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">yield</span><span style="color:#393A34;"> item  </span><span style="color:#A0ADA0;"># 将本页的数据传入 pipeline 进行数据存储</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A0ADA0;">#找到下一页的URL地址,实现翻页请求</span></span>
<span class="line"><span style="color:#393A34;">            next_url</span><span style="color:#999999;">=</span><span style="color:#393A34;">response</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">//a[@id=&#39;next&#39;]/@href</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">).</span><span style="color:#393A34;">extract_first</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#A0ADA0;"># 判断， 指如果是最后一页的话 它的 url地址为 javascript:; 就不需要执行下面的内容了。</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> next_url </span><span style="color:#AB5959;">!=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;"> javascript:;</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">                next_url</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://hr.tencent.com/</span><span style="color:#B5695999;">&quot;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;">next_url</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#A0ADA0;"># scrapy.Request能构建一个 requests对象，同时指定提取数据的 callback函数</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#1E754F;">yield</span><span style="color:#393A34;"> scrapy</span><span style="color:#999999;">.</span><span style="color:#393A34;">Request</span><span style="color:#999999;">(</span></span>
<span class="line"><span style="color:#393A34;">                    next_url</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A0ADA0;"># 这里指定的就是 def parse(self, response):本身。</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A0ADA0;"># 如果是要提取其他不同数据,要执行其他的函数 也可以在 spider文件中添加其他的爬虫函数</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#B07D48;">callback</span><span style="color:#999999;">=</span><span style="color:#A65E2B;">self</span><span style="color:#999999;">.</span><span style="color:#393A34;">parse</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A0ADA0;"># 那么 就需要添加一个 self.parse1 函数来爬取对应的数据</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#A0ADA0;"># callback = self.parse1</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#999999;">)</span></span></code></pre></div><ul><li><p>关于 scrapy.Request 的知识点</p></li><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">scrapy.Request(url, [callback=None, method=&#39;GET&#39;, headers=None, body=None, cookies=None, meta=None,</span></span>
<span class="line"><span style="color:#dbd7caee;">                         encoding=&#39;utf-8&#39;, priority=0, dont_filter=False, errback=None, flags=None])</span></span>
<span class="line"><span style="color:#dbd7caee;"></span></span>
<span class="line"><span style="color:#dbd7caee;">scrapy.Request 的常用参数为：</span></span>
<span class="line"><span style="color:#dbd7caee;">	callback: 指定传入的url交给哪个解析函数去处理</span></span>
<span class="line"><span style="color:#dbd7caee;">	meta： 实现不同的解析函数中传递数据。meta会默认携带部分消息：比如下载延迟，请求深度</span></span>
<span class="line"><span style="color:#dbd7caee;">	dont_filter: 让scrapy的去重不会过来当前url， scrapy默认有url去重功能，对需要重复请求的url有重要用途</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">scrapy.Request(url, [callback=None, method=&#39;GET&#39;, headers=None, body=None, cookies=None, meta=None,</span></span>
<span class="line"><span style="color:#393a34;">                         encoding=&#39;utf-8&#39;, priority=0, dont_filter=False, errback=None, flags=None])</span></span>
<span class="line"><span style="color:#393a34;"></span></span>
<span class="line"><span style="color:#393a34;">scrapy.Request 的常用参数为：</span></span>
<span class="line"><span style="color:#393a34;">	callback: 指定传入的url交给哪个解析函数去处理</span></span>
<span class="line"><span style="color:#393a34;">	meta： 实现不同的解析函数中传递数据。meta会默认携带部分消息：比如下载延迟，请求深度</span></span>
<span class="line"><span style="color:#393a34;">	dont_filter: 让scrapy的去重不会过来当前url， scrapy默认有url去重功能，对需要重复请求的url有重要用途</span></span></code></pre></div></li></ul><h3 id="scrapy-中的crawlspider" tabindex="-1">Scrapy 中的<a href="https://www.jianshu.com/p/a6a08b4f7c04" target="_blank" rel="noreferrer">CrawlSpider</a> <a class="header-anchor" href="#scrapy-中的crawlspider" aria-label="Permalink to &quot;Scrapy 中的[CrawlSpider](https://www.jianshu.com/p/a6a08b4f7c04)&quot;">​</a></h3><p>在此之前，我们有以大部分代码在 <strong>寻找下一页 URL 地址</strong> 或者是内容的 URL 地址上面。这一过程能更简单些吗？</p><ol><li>从 response 中提取所有的 a 标签对应的 url 地址</li><li>自动的构造自己的 requests 请求，发送给 Scrapy 引擎</li></ol><p>生成 crawlspider 爬虫文件的命令: <code>scrapy genspider -t crawl xxx爬虫名 www.xxx.com</code></p><h3 id="scrapy-持久化存储操作" tabindex="-1">scrapy 持久化存储操作 <a class="header-anchor" href="#scrapy-持久化存储操作" aria-label="Permalink to &quot;scrapy 持久化存储操作&quot;">​</a></h3><p>基于终端指令持久化操作</p><ul><li>执行指令： 执行输出指定格式进行存储：将爬取到的数据写入不同格式的文件中进行存储 <ul><li>scrapy crawl 爬虫名称 -o xxx.json <a href="https://blog.csdn.net/xiao_yi_xiao/article/details/101790680" target="_blank" rel="noreferrer">Python Scrapy 导出 json 中文乱码问题</a></li><li>不使用命令保存 JSON 的写法： <a href="https://www.cnblogs.com/sanduzxcvbnm/p/10309401.html" target="_blank" rel="noreferrer">JSON</a></li><li>scrapy crawl 爬虫名称 -o xxx.xml</li><li>scrapy crawl 爬虫名称 -o xxx.csv</li></ul></li></ul><p>基于管道持久化存储</p><ul><li><p>流程</p><ul><li><p>数据解析</p></li><li><p>在 item 类中定义相关的属性</p></li><li><p>将解析的数据封装存储到 item 类型的对象</p></li><li><p>将 item 类型的对象提交给管道进行持久化存储操作</p><ul><li><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">yield</span><span style="color:#DBD7CAEE;"> xxx</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">yield</span><span style="color:#393A34;"> xxx</span></span></code></pre></div></li></ul></li><li><p>在<code>pipelines</code>管道类的 process_item 中要将其接收到的 item 对象中存储的数据进行持久化操作</p></li><li><p>在配置文件中开启管道</p><ul><li><div class="language-pyhon vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">pyhon</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#dbd7caee;">在 settings.py 文件中 找到这部分代码 把前面的注释清楚就行。</span></span>
<span class="line"><span style="color:#dbd7caee;">ITEM_PIPELINES = {</span></span>
<span class="line"><span style="color:#dbd7caee;">   &#39;scrapy_demo01.pipelines.ScrapyDemo01Pipeline&#39;: 300,</span></span>
<span class="line"><span style="color:#dbd7caee;">}</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#393a34;">在 settings.py 文件中 找到这部分代码 把前面的注释清楚就行。</span></span>
<span class="line"><span style="color:#393a34;">ITEM_PIPELINES = {</span></span>
<span class="line"><span style="color:#393a34;">   &#39;scrapy_demo01.pipelines.ScrapyDemo01Pipeline&#39;: 300,</span></span>
<span class="line"><span style="color:#393a34;">}</span></span></code></pre></div></li></ul></li></ul></li></ul><h2 id="爬虫例子" tabindex="-1">爬虫例子： <a class="header-anchor" href="#爬虫例子" aria-label="Permalink to &quot;爬虫例子：&quot;">​</a></h2><h3 id="demo-1-爬取-豆瓣电影-排行榜-喜剧类型-的数据" tabindex="-1">Demo 1 爬取 <a href="https://movie.douban.com/" target="_blank" rel="noreferrer">豆瓣电影</a> 排行榜 （喜剧类型） 的数据 <a class="header-anchor" href="#demo-1-爬取-豆瓣电影-排行榜-喜剧类型-的数据" aria-label="Permalink to &quot;Demo 1 爬取 [豆瓣电影](https://movie.douban.com/) 排行榜 （喜剧类型） 的数据&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># https://movie.douban.com/j/chart/top_list?type=11&amp;interval_id=100%3A90&amp;action=&amp;start=0&amp;limit=20</span></span>
<span class="line"><span style="color:#758575DD;"># https://movie.douban.com/j/chart/top_list?type=11&amp;interval_id=100%3A90&amp;action=&amp;start=20&amp;limit=20</span></span>
<span class="line"><span style="color:#758575DD;"># https://movie.douban.com/j/chart/top_list?type=11&amp;interval_id=100%3A90&amp;action=&amp;start=40&amp;limit=20</span></span>
<span class="line"><span style="color:#758575DD;"># GET</span></span>
<span class="line"><span style="color:#758575DD;"># params:</span></span>
<span class="line"><span style="color:#C98A7D99;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#C98A7D;">    type: 11   # 影片类型</span></span>
<span class="line"><span style="color:#C98A7D;">    interval_id: 100:90</span></span>
<span class="line"><span style="color:#C98A7D;">    action:</span></span>
<span class="line"><span style="color:#C98A7D;">    start: 0    从第几条开始</span></span>
<span class="line"><span style="color:#C98A7D;">    limit: 1    取多少条</span></span>
<span class="line"><span style="color:#C98A7D99;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#758575DD;"># return:  [{}, {}, {},...] JSON</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> json</span></span>
<span class="line"><span style="color:#DBD7CAEE;">start </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;">   </span><span style="color:#758575DD;"># 从第几条开始</span></span>
<span class="line"><span style="color:#DBD7CAEE;">limit </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">20</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 取多少条</span></span>
<span class="line"><span style="color:#B8A965;">type</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">11</span><span style="color:#DBD7CAEE;">   </span><span style="color:#758575DD;"># 影片类型</span></span>
<span class="line"><span style="color:#758575DD;"># 请求地址</span></span>
<span class="line"><span style="color:#DBD7CAEE;">doban_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://movie.douban.com/j/chart/top_list</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#758575DD;"># headers</span></span>
<span class="line"><span style="color:#DBD7CAEE;">headers </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">User-Agent</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#758575DD;"># params</span></span>
<span class="line"><span style="color:#DBD7CAEE;">params </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">type</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">type</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">interval_id</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">100:90</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">action</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">start</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> start</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">limit</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> limit</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">response </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">doban_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">params</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> params</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">doban_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">json</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#758575DD;"># print(doban_data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 创建一个 json 文件 保存起来</span></span>
<span class="line"><span style="color:#DBD7CAEE;">f </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./dobanFile.json</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">w</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">utf-8</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">json</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">dump</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">doban_data</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fp</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">f</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ensure_ascii</span><span style="color:#666666;">=</span><span style="color:#4D9375;">False</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># json.dump 序列化时对中文默认使用的ascii编码.想输出真正的中文需要指定ensure_ascii=False</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Over!!!</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># https://movie.douban.com/j/chart/top_list?type=11&amp;interval_id=100%3A90&amp;action=&amp;start=0&amp;limit=20</span></span>
<span class="line"><span style="color:#A0ADA0;"># https://movie.douban.com/j/chart/top_list?type=11&amp;interval_id=100%3A90&amp;action=&amp;start=20&amp;limit=20</span></span>
<span class="line"><span style="color:#A0ADA0;"># https://movie.douban.com/j/chart/top_list?type=11&amp;interval_id=100%3A90&amp;action=&amp;start=40&amp;limit=20</span></span>
<span class="line"><span style="color:#A0ADA0;"># GET</span></span>
<span class="line"><span style="color:#A0ADA0;"># params:</span></span>
<span class="line"><span style="color:#B5695999;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#B56959;">    type: 11   # 影片类型</span></span>
<span class="line"><span style="color:#B56959;">    interval_id: 100:90</span></span>
<span class="line"><span style="color:#B56959;">    action:</span></span>
<span class="line"><span style="color:#B56959;">    start: 0    从第几条开始</span></span>
<span class="line"><span style="color:#B56959;">    limit: 1    取多少条</span></span>
<span class="line"><span style="color:#B5695999;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#A0ADA0;"># return:  [{}, {}, {},...] JSON</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> json</span></span>
<span class="line"><span style="color:#393A34;">start </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;">   </span><span style="color:#A0ADA0;"># 从第几条开始</span></span>
<span class="line"><span style="color:#393A34;">limit </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">20</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 取多少条</span></span>
<span class="line"><span style="color:#998418;">type</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">11</span><span style="color:#393A34;">   </span><span style="color:#A0ADA0;"># 影片类型</span></span>
<span class="line"><span style="color:#A0ADA0;"># 请求地址</span></span>
<span class="line"><span style="color:#393A34;">doban_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://movie.douban.com/j/chart/top_list</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#A0ADA0;"># headers</span></span>
<span class="line"><span style="color:#393A34;">headers </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">User-Agent</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#A0ADA0;"># params</span></span>
<span class="line"><span style="color:#393A34;">params </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">type</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#998418;">type</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">interval_id</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">100:90</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">action</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">start</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> start</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">limit</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> limit</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">response </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">doban_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">params</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> params</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">doban_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> response</span><span style="color:#999999;">.</span><span style="color:#393A34;">json</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#A0ADA0;"># print(doban_data)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 创建一个 json 文件 保存起来</span></span>
<span class="line"><span style="color:#393A34;">f </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./dobanFile.json</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">w</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">utf-8</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">json</span><span style="color:#999999;">.</span><span style="color:#393A34;">dump</span><span style="color:#999999;">(</span><span style="color:#393A34;">doban_data</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fp</span><span style="color:#999999;">=</span><span style="color:#393A34;">f</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ensure_ascii</span><span style="color:#999999;">=</span><span style="color:#1E754F;">False</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># json.dump 序列化时对中文默认使用的ascii编码.想输出真正的中文需要指定ensure_ascii=False</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Over!!!</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="demo-2-爬取-肯德基不同城市餐厅的信息" tabindex="-1">Demo 2 爬取 <a href="http://www.kfc.com.cn/kfccda/storelist/index.aspx" target="_blank" rel="noreferrer">肯德基</a>不同城市餐厅的信息 <a class="header-anchor" href="#demo-2-爬取-肯德基不同城市餐厅的信息" aria-label="Permalink to &quot;Demo 2 爬取 [肯德基](http://www.kfc.com.cn/kfccda/storelist/index.aspx)不同城市餐厅的信息&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#758575DD;"># http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=keyword</span></span>
<span class="line"><span style="color:#758575DD;"># POST</span></span>
<span class="line"><span style="color:#758575DD;"># text/plain; charset=utf-8</span></span>
<span class="line"><span style="color:#758575DD;"># User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># params:</span></span>
<span class="line"><span style="color:#C98A7D99;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#C98A7D;">URL 上的参数</span></span>
<span class="line"><span style="color:#C98A7D;">    op=keyword</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;">POST 携带的隐藏参数</span></span>
<span class="line"><span style="color:#C98A7D;">    cname:</span></span>
<span class="line"><span style="color:#C98A7D;">    pid:</span></span>
<span class="line"><span style="color:#C98A7D;">    keyword: 上饶   你想查询的城市</span></span>
<span class="line"><span style="color:#C98A7D;">    pageIndex: 1   页数</span></span>
<span class="line"><span style="color:#C98A7D;">    pageSize: 10   返回数量</span></span>
<span class="line"><span style="color:#C98A7D99;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> json</span></span>
<span class="line"><span style="color:#DBD7CAEE;">keyword </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">上海</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pageIndex </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pageSize </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">50</span></span>
<span class="line"><span style="color:#DBD7CAEE;">kdj_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">headers </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">User-Agent</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">params </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">op</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">keyword</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">form_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">cname</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">pid</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">keyword</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> keyword</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">pageIndex</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> pageIndex</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">pageSize</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> pageSize</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">response </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">post</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">kdj_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">params</span><span style="color:#DBD7CAEE;">  </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> params</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">data</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">form_data</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">kdj_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">json</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">fp </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> keyword </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">肯德基餐厅信息.json</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">w</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">utf-8</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">json</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">dump</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">kdj_data</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">fp</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">fp</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">ensure_ascii</span><span style="color:#666666;">=</span><span style="color:#4D9375;">False</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Over!!!</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=keyword</span></span>
<span class="line"><span style="color:#A0ADA0;"># POST</span></span>
<span class="line"><span style="color:#A0ADA0;"># text/plain; charset=utf-8</span></span>
<span class="line"><span style="color:#A0ADA0;"># User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># params:</span></span>
<span class="line"><span style="color:#B5695999;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#B56959;">URL 上的参数</span></span>
<span class="line"><span style="color:#B56959;">    op=keyword</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;">POST 携带的隐藏参数</span></span>
<span class="line"><span style="color:#B56959;">    cname:</span></span>
<span class="line"><span style="color:#B56959;">    pid:</span></span>
<span class="line"><span style="color:#B56959;">    keyword: 上饶   你想查询的城市</span></span>
<span class="line"><span style="color:#B56959;">    pageIndex: 1   页数</span></span>
<span class="line"><span style="color:#B56959;">    pageSize: 10   返回数量</span></span>
<span class="line"><span style="color:#B5695999;">&#39;&#39;&#39;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> json</span></span>
<span class="line"><span style="color:#393A34;">keyword </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">上海</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">pageIndex </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span></span>
<span class="line"><span style="color:#393A34;">pageSize </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">50</span></span>
<span class="line"><span style="color:#393A34;">kdj_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">headers </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">User-Agent</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">params </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">op</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">keyword</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">form_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">cname</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">pid</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">keyword</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> keyword</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">pageIndex</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> pageIndex</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">pageSize</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> pageSize</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">response </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">post</span><span style="color:#999999;">(</span><span style="color:#393A34;">kdj_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">params</span><span style="color:#393A34;">  </span><span style="color:#999999;">=</span><span style="color:#393A34;"> params</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">data</span><span style="color:#999999;">=</span><span style="color:#393A34;">form_data</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#999999;">=</span><span style="color:#393A34;">headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">kdj_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> response</span><span style="color:#999999;">.</span><span style="color:#393A34;">json</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">fp </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> keyword </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">肯德基餐厅信息.json</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">w</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">utf-8</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">json</span><span style="color:#999999;">.</span><span style="color:#393A34;">dump</span><span style="color:#999999;">(</span><span style="color:#393A34;">kdj_data</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">fp</span><span style="color:#999999;">=</span><span style="color:#393A34;">fp</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">ensure_ascii</span><span style="color:#999999;">=</span><span style="color:#1E754F;">False</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Over!!!</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="爬取某网站图片到本地" tabindex="-1">爬取某网站图片到本地 <a class="header-anchor" href="#爬取某网站图片到本地" aria-label="Permalink to &quot;爬取某网站图片到本地&quot;">​</a></h3><p><strong>Demo 3</strong></p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> re</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">base_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://qq.yh31.com/qt/fj/List_9.html</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#758575DD;"># 图片路径的前缀部分</span></span>
<span class="line"><span style="color:#DBD7CAEE;">prefix_img_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://qq.yh31.com</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 爬取网址的源码</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">orgin_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    response </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    html_str </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> html_str</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">#  爬取下一页链接网址</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">get_next_html_url</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_html_urls </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_html_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C4704F;">href=&quot;</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#B8A965;">.</span><span style="color:#C4704F;">html</span><span style="color:#666666;">)</span><span style="color:#C4704F;">&quot;</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">next</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> next_html_url</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        is_true </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">match</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#B8A965;">^</span><span style="color:#C4704F;">/qt/fj/List_</span><span style="color:#B8A965;">\\d.</span><span style="color:#C4704F;">html</span><span style="color:#B8A965;">$</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">next</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> is_true </span><span style="color:#CB7676;">!=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">None</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">next</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://qq.yh31.com</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">next</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            next_html_urls</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#B8A965;">next</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> next_html_urls</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">pop</span><span style="color:#666666;">()</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 删除链接重复的一个</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> next_url</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">sum_img_count </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span></span>
<span class="line"><span style="color:#758575DD;"># 爬取图片 url: 爬取那个网页的网址  prefix_img_url: 图片网址的前缀部分</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">getImgs</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;">prefix_img_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> sum_img_count</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> orgin_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    imgSrc </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C4704F;">src=&quot;</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#B8A965;">.</span><span style="color:#C4704F;">jpg</span><span style="color:#666666;">)</span><span style="color:#C4704F;">&quot;</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> get_next_html_url</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 下一页网址链接</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 爬取图片</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    num </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> sum_img_count</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> item_url </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> imgSrc</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        is_true </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> item_url</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">startswith</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">/tp</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> is_true</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            item_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> prefix_img_url </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> item_url</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        img_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">item_url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">with</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#CB7676;">rf</span><span style="color:#C98A7D;">&#39;./图片/demo01/</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">num</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">.jpg&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">wb</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">as</span><span style="color:#DBD7CAEE;"> f</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">img_data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">content</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">close</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#CB7676;">f</span><span style="color:#C98A7D;">&#39;第</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">num</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">张图片下载完毕&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            num </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> num </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    sum_img_count </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> num</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    getImgs</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> prefix_img_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> sum_img_count</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">getImgs</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">base_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> prefix_img_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> sum_img_count</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> re</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">base_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://qq.yh31.com/qt/fj/List_9.html</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#A0ADA0;"># 图片路径的前缀部分</span></span>
<span class="line"><span style="color:#393A34;">prefix_img_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://qq.yh31.com</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 爬取网址的源码</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">orgin_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    response </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    html_str </span><span style="color:#999999;">=</span><span style="color:#393A34;"> response</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> html_str</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">#  爬取下一页链接网址</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">get_next_html_url</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    next_html_urls </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">    next_html_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5E3F;">href=&quot;</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#998418;">.</span><span style="color:#AB5E3F;">html</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">&quot;</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> </span><span style="color:#998418;">next</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> next_html_url</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        is_true </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">match</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#998418;">^</span><span style="color:#AB5E3F;">/qt/fj/List_</span><span style="color:#998418;">\\d.</span><span style="color:#AB5E3F;">html</span><span style="color:#998418;">$</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#998418;">next</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> is_true </span><span style="color:#AB5959;">!=</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">None</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">next</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://qq.yh31.com</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#998418;">next</span></span>
<span class="line"><span style="color:#393A34;">            next_html_urls</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#998418;">next</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    next_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> next_html_urls</span><span style="color:#999999;">.</span><span style="color:#393A34;">pop</span><span style="color:#999999;">()</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 删除链接重复的一个</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> next_url</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">sum_img_count </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span></span>
<span class="line"><span style="color:#A0ADA0;"># 爬取图片 url: 爬取那个网页的网址  prefix_img_url: 图片网址的前缀部分</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">getImgs</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">,</span><span style="color:#393A34;">prefix_img_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> sum_img_count</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> orgin_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    imgSrc </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5E3F;">src=&quot;</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#998418;">.</span><span style="color:#AB5E3F;">jpg</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">&quot;</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    next_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> get_next_html_url</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 下一页网址链接</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 爬取图片</span></span>
<span class="line"><span style="color:#393A34;">    num </span><span style="color:#999999;">=</span><span style="color:#393A34;"> sum_img_count</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> item_url </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> imgSrc</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        is_true </span><span style="color:#999999;">=</span><span style="color:#393A34;"> item_url</span><span style="color:#999999;">.</span><span style="color:#393A34;">startswith</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">/tp</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> is_true</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            item_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> prefix_img_url </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> item_url</span></span>
<span class="line"><span style="color:#393A34;">        img_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">item_url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">with</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#AB5959;">rf</span><span style="color:#B56959;">&#39;./图片/demo01/</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">num</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">.jpg&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">wb</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">as</span><span style="color:#393A34;"> f</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            f</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">img_data</span><span style="color:#999999;">.</span><span style="color:#393A34;">content</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            f</span><span style="color:#999999;">.</span><span style="color:#393A34;">close</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#AB5959;">f</span><span style="color:#B56959;">&#39;第</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">num</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">张图片下载完毕&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            num </span><span style="color:#999999;">=</span><span style="color:#393A34;"> num </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span></span>
<span class="line"><span style="color:#393A34;">    sum_img_count </span><span style="color:#999999;">=</span><span style="color:#393A34;"> num</span></span>
<span class="line"><span style="color:#393A34;">    getImgs</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> prefix_img_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> sum_img_count</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">getImgs</span><span style="color:#999999;">(</span><span style="color:#393A34;">base_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> prefix_img_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> sum_img_count</span><span style="color:#999999;">)</span></span></code></pre></div><p><strong>Demo 4</strong></p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> re</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests</span></span>
<span class="line"><span style="color:#DBD7CAEE;">base_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.netbian.com/index.htm</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">headers </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">User-Agent</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#758575DD;"># 爬取网页源码</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">orgin_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    response </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取下一页网址  html： 网页解析出来的源码</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">next_url</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 选出以 htm 结尾的 地址</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    urls </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C4704F;">href=&quot;</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#B8A965;">.</span><span style="color:#C4704F;">htm</span><span style="color:#666666;">)</span><span style="color:#C4704F;">&quot;</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">next</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> urls</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">next</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">startswith</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">/index</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">next</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.netbian.com</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">next</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            url</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#B8A965;">next</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 下一页的网址</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> url</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">pop</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 爬取 图片</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">get_img</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> count</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    imgs </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C4704F;">src=&quot;</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#B8A965;">.</span><span style="color:#C4704F;">jpg</span><span style="color:#666666;">)</span><span style="color:#C4704F;">&quot;</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    num </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> count</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> img_url </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> imgs</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        img_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">img_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">with</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#CB7676;">rf</span><span style="color:#C98A7D;">&#39;./图片/电脑壁纸/第</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">num</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">张.jpg&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">wb</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">as</span><span style="color:#DBD7CAEE;"> fp</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            fp</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">img_data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">content</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            fp</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">close</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#CB7676;">f</span><span style="color:#C98A7D;">&#39;第</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">num</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">张图片下载完毕&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            num </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> num </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> num</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">#图片累计数量</span></span>
<span class="line"><span style="color:#758575DD;"># imgs_count = 0</span></span>
<span class="line"><span style="color:#758575DD;"># 爬取网页图片 url：爬取的网址</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">climb_imgs</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> count</span><span style="color:#CB7676;">=</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> orgin_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 下一页的链接的地址</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    get_next_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> next_url</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    img_count </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> get_img</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> count</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 爬取下一页图片</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    climb_imgs</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">get_next_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> img_count</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">climb_imgs</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">base_url</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> re</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests</span></span>
<span class="line"><span style="color:#393A34;">base_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.netbian.com/index.htm</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">headers </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">User-Agent</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#A0ADA0;"># 爬取网页源码</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">orgin_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    response </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> response</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取下一页网址  html： 网页解析出来的源码</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">next_url</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 选出以 htm 结尾的 地址</span></span>
<span class="line"><span style="color:#393A34;">    urls </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5E3F;">href=&quot;</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#998418;">.</span><span style="color:#AB5E3F;">htm</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">&quot;</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> </span><span style="color:#998418;">next</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> urls</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#998418;">next</span><span style="color:#999999;">.</span><span style="color:#393A34;">startswith</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">/index</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">next</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.netbian.com</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#998418;">next</span></span>
<span class="line"><span style="color:#393A34;">            url</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#998418;">next</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 下一页的网址</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> url</span><span style="color:#999999;">.</span><span style="color:#393A34;">pop</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 爬取 图片</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">get_img</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">,</span><span style="color:#393A34;"> count</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    imgs </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5E3F;">src=&quot;</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#998418;">.</span><span style="color:#AB5E3F;">jpg</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">&quot;</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    num </span><span style="color:#999999;">=</span><span style="color:#393A34;"> count</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> img_url </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> imgs</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        img_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">img_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#999999;">=</span><span style="color:#393A34;">headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">with</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#AB5959;">rf</span><span style="color:#B56959;">&#39;./图片/电脑壁纸/第</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">num</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">张.jpg&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">wb</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">as</span><span style="color:#393A34;"> fp</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            fp</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">img_data</span><span style="color:#999999;">.</span><span style="color:#393A34;">content</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            fp</span><span style="color:#999999;">.</span><span style="color:#393A34;">close</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#AB5959;">f</span><span style="color:#B56959;">&#39;第</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">num</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">张图片下载完毕&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            num </span><span style="color:#999999;">=</span><span style="color:#393A34;"> num </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> num</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">#图片累计数量</span></span>
<span class="line"><span style="color:#A0ADA0;"># imgs_count = 0</span></span>
<span class="line"><span style="color:#A0ADA0;"># 爬取网页图片 url：爬取的网址</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">climb_imgs</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> count</span><span style="color:#AB5959;">=</span><span style="color:#2F798A;">1</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> orgin_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 下一页的链接的地址</span></span>
<span class="line"><span style="color:#393A34;">    get_next_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> next_url</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    img_count </span><span style="color:#999999;">=</span><span style="color:#393A34;"> get_img</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">,</span><span style="color:#393A34;"> count</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 爬取下一页图片</span></span>
<span class="line"><span style="color:#393A34;">    climb_imgs</span><span style="color:#999999;">(</span><span style="color:#393A34;">get_next_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> img_count</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">climb_imgs</span><span style="color:#999999;">(</span><span style="color:#393A34;">base_url</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="bs4-爬取三国演义" tabindex="-1">bs4 爬取三国演义 <a class="header-anchor" href="#bs4-爬取三国演义" aria-label="Permalink to &quot;bs4 爬取三国演义&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> bs4 </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> BeautifulSoup</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">base_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://www.shicimingju.com/book/sanguoyanyi.html</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">headers </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">User-Agent</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">response </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">base_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">soup </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> BeautifulSoup</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">lxml</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">li_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> soup</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">select</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">.book-mulu ul li</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">f </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#BD976A;">file</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./三国演义.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">mode</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">w</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">utf8</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> li </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> li_list</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 章节标题</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    title </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> li</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">a</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">string</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 该章节的内容 链接</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    work_content </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> li</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">a</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">href</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    work_content </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://www.shicimingju.com</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> work_content</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#CB7676;">f</span><span style="color:#C98A7D;">&quot;爬取</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">title</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">....&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 爬取 内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    content </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">work_content</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    content_soup </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> BeautifulSoup</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">content</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">lxml</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 该章节内容</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    content_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> content_soup</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">find</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">div</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">class_</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">chapter_content</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">text</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#CB7676;">f</span><span style="color:#C98A7D;">&quot;</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">title</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">: </span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">content_list</span><span style="color:#C99076;">}\\n</span><span style="color:#C98A7D;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">close</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">三国演义爬取完毕!</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> bs4 </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> BeautifulSoup</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">base_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://www.shicimingju.com/book/sanguoyanyi.html</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">headers </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">User-Agent</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">response </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">base_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">soup </span><span style="color:#999999;">=</span><span style="color:#393A34;"> BeautifulSoup</span><span style="color:#999999;">(</span><span style="color:#393A34;">response</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">lxml</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">li_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> soup</span><span style="color:#999999;">.</span><span style="color:#393A34;">select</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">.book-mulu ul li</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">f </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#B07D48;">file</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./三国演义.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">mode</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">w</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">utf8</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#1E754F;">for</span><span style="color:#393A34;"> li </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> li_list</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 章节标题</span></span>
<span class="line"><span style="color:#393A34;">    title </span><span style="color:#999999;">=</span><span style="color:#393A34;"> li</span><span style="color:#999999;">.</span><span style="color:#393A34;">a</span><span style="color:#999999;">.</span><span style="color:#393A34;">string</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 该章节的内容 链接</span></span>
<span class="line"><span style="color:#393A34;">    work_content </span><span style="color:#999999;">=</span><span style="color:#393A34;"> li</span><span style="color:#999999;">.</span><span style="color:#393A34;">a</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">href</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    work_content </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://www.shicimingju.com</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> work_content</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#AB5959;">f</span><span style="color:#B56959;">&quot;爬取</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">title</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">....&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 爬取 内容</span></span>
<span class="line"><span style="color:#393A34;">    content </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">work_content</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    content_soup </span><span style="color:#999999;">=</span><span style="color:#393A34;"> BeautifulSoup</span><span style="color:#999999;">(</span><span style="color:#393A34;">content</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">lxml</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 该章节内容</span></span>
<span class="line"><span style="color:#393A34;">    content_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> content_soup</span><span style="color:#999999;">.</span><span style="color:#393A34;">find</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">div</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">class_</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">chapter_content</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">).</span><span style="color:#393A34;">text</span></span>
<span class="line"><span style="color:#393A34;">    f</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#AB5959;">f</span><span style="color:#B56959;">&quot;</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">title</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">: </span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">content_list</span><span style="color:#A65E2B;">}\\n</span><span style="color:#B56959;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">f</span><span style="color:#999999;">.</span><span style="color:#393A34;">close</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">三国演义爬取完毕!</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="爬取彼岸桌面-4k-高清图片" tabindex="-1">爬取彼岸桌面 4K 高清图片 <a class="header-anchor" href="#爬取彼岸桌面-4k-高清图片" aria-label="Permalink to &quot;爬取彼岸桌面 4K 高清图片&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> lxml </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> etree</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> os</span></span>
<span class="line"><span style="color:#758575DD;"># 美女类</span></span>
<span class="line"><span style="color:#DBD7CAEE;">base_url_1 </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.netbian.com/meinv/index.htm</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#758575DD;"># 动漫类</span></span>
<span class="line"><span style="color:#DBD7CAEE;">base_url_2 </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.netbian.com/dongman</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#758575DD;"># 游戏类</span></span>
<span class="line"><span style="color:#DBD7CAEE;">base_url_3 </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.netbian.com/youxi</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">headers </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">User-Agent</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取html页面源码 url：网页地址</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">get_html_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    response </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 网页源码 编码方式为 gbk</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">encoding </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">gbk</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取下一页链接 html: 网页源码</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">get_next_html_url</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 实例化 tree 对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    tree_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> etree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">HTML</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_page_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> tree_html</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">//div[@class=&quot;page&quot;]/a</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> next_page </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> next_page_list</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        is_next_page </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> next_page</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./text()</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">if</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">is_next_page</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">下一页&gt;</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            next_page_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://netbian.com</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> next_page</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./@href</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            url</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_page_url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> url</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 爬取图片</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">get_url1_a_href</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 实例化 tree 对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    tree_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> etree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">HTML</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 下一页的链接</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_page_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> get_next_html_url</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_page_url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 爬取第一个网页的 图片 a 标签链接</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    li_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> tree_html</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">//div[@class=&quot;list&quot;]/ul/li</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 观察发现 li_list 第三个和其他的标签结果不一样。 所以删除</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">del</span><span style="color:#DBD7CAEE;"> li_list</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">2</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 判断 本地文件夹是否存在</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    file_path </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">./图片/4K游戏图片</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    is_file_exist </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">exists</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">file_path</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 文件不存在</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> is_file_exist </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">False</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">mkdir</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">file_path</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> li </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> li_list</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        a_href </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.netbian.com</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> li</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./a//@href</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        next_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> get_html_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">a_href</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 实例化 tree 对象</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        tree_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> etree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">HTML</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 获取到 真正4K图片的URL</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        img_4k_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">http://www.netbian.com</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> tree_html</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">//div[@class=&quot;pic-down&quot;]/a/@href</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 爬取真正的 4K图片</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        next_4k_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> get_html_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">img_4k_url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        img_4k_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> etree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">HTML</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_4k_html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 4K图片下载地址</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        download_4kimg_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> img_4k_html</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">//table//a/@href</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        title_4kimg </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> img_4k_html</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">//table//a/@title</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 下载图片到本地</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        img_4k_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">download_4kimg_url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 往文件夹里写图片</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">with</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#CB7676;">rf</span><span style="color:#C98A7D;">&#39;</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">file_path</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">/</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">title_4kimg</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">.jpg&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">wb</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">as</span><span style="color:#DBD7CAEE;"> fp</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            fp</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">img_4k_data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">content</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#CB7676;">f</span><span style="color:#C98A7D;">&#39;</span><span style="color:#C99076;">{</span><span style="color:#DBD7CAEE;">title_4kimg</span><span style="color:#C99076;">}</span><span style="color:#C98A7D;">下载完毕&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 爬取下一页</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_page_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> get_html_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_page_url</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    get_url1_a_href</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_page_html</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> get_html_code</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">base_url_3</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">get_url1_a_href</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> lxml </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> etree</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> os</span></span>
<span class="line"><span style="color:#A0ADA0;"># 美女类</span></span>
<span class="line"><span style="color:#393A34;">base_url_1 </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.netbian.com/meinv/index.htm</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#A0ADA0;"># 动漫类</span></span>
<span class="line"><span style="color:#393A34;">base_url_2 </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.netbian.com/dongman</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#A0ADA0;"># 游戏类</span></span>
<span class="line"><span style="color:#393A34;">base_url_3 </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.netbian.com/youxi</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">headers </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">User-Agent</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取html页面源码 url：网页地址</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">get_html_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    response </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 网页源码 编码方式为 gbk</span></span>
<span class="line"><span style="color:#393A34;">    response</span><span style="color:#999999;">.</span><span style="color:#393A34;">encoding </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">gbk</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> response</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取下一页链接 html: 网页源码</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">get_next_html_url</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 实例化 tree 对象</span></span>
<span class="line"><span style="color:#393A34;">    tree_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> etree</span><span style="color:#999999;">.</span><span style="color:#393A34;">HTML</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    next_page_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> tree_html</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">//div[@class=&quot;page&quot;]/a</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> next_page </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> next_page_list</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        is_next_page </span><span style="color:#999999;">=</span><span style="color:#393A34;"> next_page</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./text()</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">if</span><span style="color:#999999;">(</span><span style="color:#393A34;">is_next_page</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">下一页&gt;</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">            next_page_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://netbian.com</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> next_page</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./@href</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">            url</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_page_url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> url</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 爬取图片</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">get_url1_a_href</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 实例化 tree 对象</span></span>
<span class="line"><span style="color:#393A34;">    tree_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> etree</span><span style="color:#999999;">.</span><span style="color:#393A34;">HTML</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 下一页的链接</span></span>
<span class="line"><span style="color:#393A34;">    next_page_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> get_next_html_url</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_page_url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 爬取第一个网页的 图片 a 标签链接</span></span>
<span class="line"><span style="color:#393A34;">    li_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> tree_html</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">//div[@class=&quot;list&quot;]/ul/li</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 观察发现 li_list 第三个和其他的标签结果不一样。 所以删除</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">del</span><span style="color:#393A34;"> li_list</span><span style="color:#999999;">[</span><span style="color:#2F798A;">2</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 判断 本地文件夹是否存在</span></span>
<span class="line"><span style="color:#393A34;">    file_path </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">./图片/4K游戏图片</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">    is_file_exist </span><span style="color:#999999;">=</span><span style="color:#393A34;"> os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">exists</span><span style="color:#999999;">(</span><span style="color:#393A34;">file_path</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 文件不存在</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> is_file_exist </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">False</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        os</span><span style="color:#999999;">.</span><span style="color:#393A34;">mkdir</span><span style="color:#999999;">(</span><span style="color:#393A34;">file_path</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> li </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> li_list</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        a_href </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.netbian.com</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> li</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./a//@href</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">        next_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> get_html_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">a_href</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 实例化 tree 对象</span></span>
<span class="line"><span style="color:#393A34;">        tree_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> etree</span><span style="color:#999999;">.</span><span style="color:#393A34;">HTML</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 获取到 真正4K图片的URL</span></span>
<span class="line"><span style="color:#393A34;">        img_4k_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">http://www.netbian.com</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> tree_html</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">//div[@class=&quot;pic-down&quot;]/a/@href</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 爬取真正的 4K图片</span></span>
<span class="line"><span style="color:#393A34;">        next_4k_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> get_html_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">img_4k_url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        img_4k_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> etree</span><span style="color:#999999;">.</span><span style="color:#393A34;">HTML</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_4k_html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 4K图片下载地址</span></span>
<span class="line"><span style="color:#393A34;">        download_4kimg_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> img_4k_html</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">//table//a/@href</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">        title_4kimg </span><span style="color:#999999;">=</span><span style="color:#393A34;"> img_4k_html</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">//table//a/@title</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 下载图片到本地</span></span>
<span class="line"><span style="color:#393A34;">        img_4k_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">download_4kimg_url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 往文件夹里写图片</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">with</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#AB5959;">rf</span><span style="color:#B56959;">&#39;</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">file_path</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">/</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">title_4kimg</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">.jpg&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">wb</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">as</span><span style="color:#393A34;"> fp</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            fp</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">img_4k_data</span><span style="color:#999999;">.</span><span style="color:#393A34;">content</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#AB5959;">f</span><span style="color:#B56959;">&#39;</span><span style="color:#A65E2B;">{</span><span style="color:#393A34;">title_4kimg</span><span style="color:#A65E2B;">}</span><span style="color:#B56959;">下载完毕&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 爬取下一页</span></span>
<span class="line"><span style="color:#393A34;">    next_page_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> get_html_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_page_url</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    get_url1_a_href</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_page_html</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> get_html_code</span><span style="color:#999999;">(</span><span style="color:#393A34;">base_url_3</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">get_url1_a_href</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="体验使用线程池爬取-梨视频的四个视频" tabindex="-1">体验使用线程池爬取 梨视频的四个视频 <a class="header-anchor" href="#体验使用线程池爬取-梨视频的四个视频" aria-label="Permalink to &quot;体验使用线程池爬取 梨视频的四个视频&quot;">​</a></h3><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> lxml </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> etree</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> re</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> os</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> multiprocessing</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">dummy </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> Pool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">base_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://www.pearvideo.com/category_5</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">headers </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">User-Agent</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">response </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">base_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">headers</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">tree </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> etree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">HTML</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">response</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">text</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">li_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> tree</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">//*[@id=&quot;listvideoList&quot;]/ul/li</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># 列表， 存放视频名字， 地址</span></span>
<span class="line"><span style="color:#DBD7CAEE;">videoes </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> li </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> li_list</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">https://www.pearvideo.com/</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> li</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./div/a/@href</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 视频名字</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    video_name </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> li</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">xpath</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">./div/a/div[@class=&quot;vervideo-title&quot;]/text()</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">.mp4</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    next_url_html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">next_url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">text</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    re_str </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">srcUrl=&quot;(.*?)&quot;,vdoUrl=srcUrl</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 视频链接</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    video_url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">re_str</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> next_url_html</span><span style="color:#666666;">)[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    dic </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> video_name</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">video_url</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> video_url</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    videoes</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">dic</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">file_path </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">./视频/梨视频</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">is_file_exist </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">path</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">exists</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">file_path</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># 文件不存在</span></span>
<span class="line"><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> is_file_exist </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">False</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    os</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">makedirs</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">file_path</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">download_video</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">dic</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">dic</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">video_url</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    video_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">dic</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">video_url</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">],</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">content</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">dic</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">下载中...</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">with</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">file_path</span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;">dic</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">],</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">wb</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">as</span><span style="color:#DBD7CAEE;"> fp</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        fp</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">video_data</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">dic</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">下载完成</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">pool </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> Pool</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">4</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pool</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">map</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">download_video</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> videoes</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">pool</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">close</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pool</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">join</span><span style="color:#666666;">()</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> lxml </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> etree</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> re</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> os</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> multiprocessing</span><span style="color:#999999;">.</span><span style="color:#393A34;">dummy </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> Pool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">base_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://www.pearvideo.com/category_5</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">headers </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">User-Agent</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">response </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">base_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#999999;">=</span><span style="color:#393A34;">headers</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">tree </span><span style="color:#999999;">=</span><span style="color:#393A34;"> etree</span><span style="color:#999999;">.</span><span style="color:#393A34;">HTML</span><span style="color:#999999;">(</span><span style="color:#393A34;">response</span><span style="color:#999999;">.</span><span style="color:#393A34;">text</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">li_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> tree</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">//*[@id=&quot;listvideoList&quot;]/ul/li</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># 列表， 存放视频名字， 地址</span></span>
<span class="line"><span style="color:#393A34;">videoes </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#1E754F;">for</span><span style="color:#393A34;"> li </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> li_list</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">    next_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">https://www.pearvideo.com/</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> li</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./div/a/@href</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 视频名字</span></span>
<span class="line"><span style="color:#393A34;">    video_name </span><span style="color:#999999;">=</span><span style="color:#393A34;"> li</span><span style="color:#999999;">.</span><span style="color:#393A34;">xpath</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">./div/a/div[@class=&quot;vervideo-title&quot;]/text()</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">.mp4</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    next_url_html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">next_url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">).</span><span style="color:#393A34;">text</span></span>
<span class="line"><span style="color:#393A34;">    re_str </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">srcUrl=&quot;(.*?)&quot;,vdoUrl=srcUrl</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 视频链接</span></span>
<span class="line"><span style="color:#393A34;">    video_url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#393A34;">re_str</span><span style="color:#999999;">,</span><span style="color:#393A34;"> next_url_html</span><span style="color:#999999;">)[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">    dic </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> video_name</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">video_url</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> video_url</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    videoes</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">dic</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">file_path </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">./视频/梨视频</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">is_file_exist </span><span style="color:#999999;">=</span><span style="color:#393A34;"> os</span><span style="color:#999999;">.</span><span style="color:#393A34;">path</span><span style="color:#999999;">.</span><span style="color:#393A34;">exists</span><span style="color:#999999;">(</span><span style="color:#393A34;">file_path</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># 文件不存在</span></span>
<span class="line"><span style="color:#1E754F;">if</span><span style="color:#393A34;"> is_file_exist </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">False</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">    os</span><span style="color:#999999;">.</span><span style="color:#393A34;">makedirs</span><span style="color:#999999;">(</span><span style="color:#393A34;">file_path</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">download_video</span><span style="color:#999999;">(</span><span style="color:#393A34;">dic</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">dic</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">video_url</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#393A34;">    video_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">dic</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">video_url</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">],</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">).</span><span style="color:#393A34;">content</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">dic</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">下载中...</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">with</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#999999;">(</span><span style="color:#393A34;">file_path</span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">/</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;">dic</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">],</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">wb</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">as</span><span style="color:#393A34;"> fp</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        fp</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">video_data</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#393A34;">dic</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">下载完成</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">pool </span><span style="color:#999999;">=</span><span style="color:#393A34;"> Pool</span><span style="color:#999999;">(</span><span style="color:#2F798A;">4</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">pool</span><span style="color:#999999;">.</span><span style="color:#393A34;">map</span><span style="color:#999999;">(</span><span style="color:#393A34;">download_video</span><span style="color:#999999;">,</span><span style="color:#393A34;"> videoes</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">pool</span><span style="color:#999999;">.</span><span style="color:#393A34;">close</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#393A34;">pool</span><span style="color:#999999;">.</span><span style="color:#393A34;">join</span><span style="color:#999999;">()</span></span></code></pre></div><h3 id="爬取前程无忧-web-前端岗位信息-本地存储" tabindex="-1">爬取前程无忧 Web 前端岗位信息， 本地存储 <a class="header-anchor" href="#爬取前程无忧-web-前端岗位信息-本地存储" aria-label="Permalink to &quot;爬取前程无忧 Web 前端岗位信息， 本地存储&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> requests;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> re;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> json;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 获取源码</span></span>
<span class="line"><span style="color:#758575DD;"># page 页数</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">get_content</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">page</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># 000000,000000,0000,00,9,99, 代表的是 全国</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#758575DD;"># Web 是搜索的岗位关键词</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    url </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">https://search.51job.com/list/000000,000000,0000,00,9,99,Web,2,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">str</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">page</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">.html</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    headers </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">{</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">User-Agent</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#666666;">}</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    html </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> requests</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">url</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">headers</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> headers</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">text</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> html</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># html 源码</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C4704F;">window</span><span style="color:#B8A965;">.</span><span style="color:#C4704F;">__SEARCH_RESULT__ =</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#666666;">)</span><span style="color:#C4704F;">&lt;/script&gt;</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> html</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">return</span><span style="color:#DBD7CAEE;"> json</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">loads</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">data</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">])[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">engine_search_result</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;"># 1. 保存在本地 txt</span></span>
<span class="line"><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;">  j </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">10</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">     </span><span style="color:#B8A965;">print</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">正在爬取第</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#CB7676;">+</span><span style="color:#B8A965;">str</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">j</span><span style="color:#666666;">)</span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">页数据...</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">     html</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;">get_content</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">j</span><span style="color:#666666;">)</span><span style="color:#758575DD;">#调用获取网页原码</span></span>
<span class="line"><span style="color:#DBD7CAEE;">     </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> i </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">html</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#758575DD;"># print(i)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#758575DD;"># i[&#39;job_name&#39;] 职位名称</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#758575DD;"># i[&#39;company_name&#39;] 公司名称</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#758575DD;"># salary 薪资待遇</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#758575DD;"># i[&#39;workarea_text&#39;] 公司位置</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#758575DD;"># treatment 公司福利</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#758575DD;"># i[&#39;attribute_text&#39;]  相关条件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         require </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> item </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">attribute_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">             require </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> require  </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> item </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C99076;">\\t</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         salary </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">providesalary_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">providesalary_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">薪酬未知</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         treatment </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">jobwelf</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">jobwelf</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!=</span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">待遇未知</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">         </span><span style="color:#4D9375;">with</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">open</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">51job.txt</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">a</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">utf-8</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">as</span><span style="color:#DBD7CAEE;"> f</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">             f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">job_name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C99076;">\\t</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">company_name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C99076;">\\t</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;">salary</span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C99076;">\\t</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">workarea_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C99076;">\\t</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;">treatment</span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C99076;">\\t</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;">require</span><span style="color:#CB7676;">+</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C99076;">\\n</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">             f</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">close</span><span style="color:#666666;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 2. 写入 excel 文件里</span></span>
<span class="line"><span style="color:#DBD7CAEE;">workbook </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlwt</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">Workbook</span><span style="color:#666666;">(</span><span style="color:#BD976A;">encoding</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">utf-8</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">worksheet </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> workbook</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add_sheet</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">51job</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">headData </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">招聘职位</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">公司名称</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">薪资待遇</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">公司位置</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">公司福利</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">相关信息</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#758575DD;">#表头部信息</span></span>
<span class="line"><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> colnum </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">6</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">     worksheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> colnum</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> headData</span><span style="color:#666666;">[</span><span style="color:#DBD7CAEE;">colnum</span><span style="color:#666666;">],</span><span style="color:#DBD7CAEE;"> xlwt</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">easyxf</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">font: bold on</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">))</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 行，列</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 把爬取的内容写到 excel</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">excel_write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">content</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> index</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> i </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> content</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">job_name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">company_name</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        salary </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">providesalary_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">providesalary_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">薪酬未知</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">salary</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">workarea_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        treatment </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">jobwelf</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">jobwelf</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;&#39;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">待遇未知</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">treatment</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        require </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> item </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">attribute_text</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">]:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">          require </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> require  </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> item </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C99076;">\\t</span><span style="color:#C98A7D99;">&#39;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">require</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> i </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">6</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            worksheet</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">index</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> i</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> data</span><span style="color:#666666;">[</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        index</span><span style="color:#666666;">+=</span><span style="color:#4C9A91;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> each </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#4C9A91;">10</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    index </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">each</span><span style="color:#CB7676;">-</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">)</span><span style="color:#CB7676;">*</span><span style="color:#4C9A91;">50</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">+</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    excel_write</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">get</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">get_content</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">each</span><span style="color:#666666;">)),</span><span style="color:#DBD7CAEE;"> index</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">workbook</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">save</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">51job.xls</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> requests;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> re;</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> json;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 获取源码</span></span>
<span class="line"><span style="color:#A0ADA0;"># page 页数</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">get_content</span><span style="color:#999999;">(</span><span style="color:#393A34;">page</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># 000000,000000,0000,00,9,99, 代表的是 全国</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># Web 是搜索的岗位关键词</span></span>
<span class="line"><span style="color:#393A34;">    url </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">https://search.51job.com/list/000000,000000,0000,00,9,99,Web,2,</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#998418;">str</span><span style="color:#999999;">(</span><span style="color:#393A34;">page</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">.html</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">    headers </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">{</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">User-Agent</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#999999;">}</span></span>
<span class="line"><span style="color:#393A34;">    html </span><span style="color:#999999;">=</span><span style="color:#393A34;"> requests</span><span style="color:#999999;">.</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">url</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">headers</span><span style="color:#393A34;"> </span><span style="color:#999999;">=</span><span style="color:#393A34;"> headers</span><span style="color:#999999;">).</span><span style="color:#393A34;">text</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> html</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># html 源码</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5E3F;">window</span><span style="color:#998418;">.</span><span style="color:#AB5E3F;">__SEARCH_RESULT__ =</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">&lt;/script&gt;</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> html</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">return</span><span style="color:#393A34;"> json</span><span style="color:#999999;">.</span><span style="color:#393A34;">loads</span><span style="color:#999999;">(</span><span style="color:#393A34;">data</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">])[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">engine_search_result</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"> </span><span style="color:#A0ADA0;"># 1. 保存在本地 txt</span></span>
<span class="line"><span style="color:#1E754F;">for</span><span style="color:#393A34;">  j </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#2F798A;">10</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">     </span><span style="color:#998418;">print</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">正在爬取第</span><span style="color:#B5695999;">&quot;</span><span style="color:#AB5959;">+</span><span style="color:#998418;">str</span><span style="color:#999999;">(</span><span style="color:#393A34;">j</span><span style="color:#999999;">)</span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">页数据...</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">     html</span><span style="color:#999999;">=</span><span style="color:#393A34;">get_content</span><span style="color:#999999;">(</span><span style="color:#393A34;">j</span><span style="color:#999999;">)</span><span style="color:#A0ADA0;">#调用获取网页原码</span></span>
<span class="line"><span style="color:#393A34;">     </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> i </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> get</span><span style="color:#999999;">(</span><span style="color:#393A34;">html</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#A0ADA0;"># print(i)</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#A0ADA0;"># i[&#39;job_name&#39;] 职位名称</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#A0ADA0;"># i[&#39;company_name&#39;] 公司名称</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#A0ADA0;"># salary 薪资待遇</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#A0ADA0;"># i[&#39;workarea_text&#39;] 公司位置</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#A0ADA0;"># treatment 公司福利</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#A0ADA0;"># i[&#39;attribute_text&#39;]  相关条件</span></span>
<span class="line"><span style="color:#393A34;">         require </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;&quot;</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> item </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">attribute_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]:</span></span>
<span class="line"><span style="color:#393A34;">             require </span><span style="color:#999999;">=</span><span style="color:#393A34;"> require  </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> item </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#A65E2B;">\\t</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">         salary </span><span style="color:#999999;">=</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">providesalary_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">providesalary_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">薪酬未知</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">         treatment </span><span style="color:#999999;">=</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">jobwelf</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">jobwelf</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!=</span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">待遇未知</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">         </span><span style="color:#1E754F;">with</span><span style="color:#393A34;"> </span><span style="color:#998418;">open</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">51job.txt</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">a</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">utf-8</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">as</span><span style="color:#393A34;"> f</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">             f</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">job_name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&#39;</span><span style="color:#A65E2B;">\\t</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;">i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">company_name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&#39;</span><span style="color:#A65E2B;">\\t</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;">salary</span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&#39;</span><span style="color:#A65E2B;">\\t</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;">i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">workarea_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&#39;</span><span style="color:#A65E2B;">\\t</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5959;">+</span><span style="color:#393A34;">treatment</span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#A65E2B;">\\t</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;">require</span><span style="color:#AB5959;">+</span><span style="color:#B5695999;">&#39;</span><span style="color:#A65E2B;">\\n</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">             f</span><span style="color:#999999;">.</span><span style="color:#393A34;">close</span><span style="color:#999999;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 2. 写入 excel 文件里</span></span>
<span class="line"><span style="color:#393A34;">workbook </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlwt</span><span style="color:#999999;">.</span><span style="color:#393A34;">Workbook</span><span style="color:#999999;">(</span><span style="color:#B07D48;">encoding</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">utf-8</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">worksheet </span><span style="color:#999999;">=</span><span style="color:#393A34;"> workbook</span><span style="color:#999999;">.</span><span style="color:#393A34;">add_sheet</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">51job</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">headData </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">招聘职位</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">公司名称</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">薪资待遇</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">公司位置</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">公司福利</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">相关信息</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#A0ADA0;">#表头部信息</span></span>
<span class="line"><span style="color:#1E754F;">for</span><span style="color:#393A34;"> colnum </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">6</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">     worksheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#393A34;"> colnum</span><span style="color:#999999;">,</span><span style="color:#393A34;"> headData</span><span style="color:#999999;">[</span><span style="color:#393A34;">colnum</span><span style="color:#999999;">],</span><span style="color:#393A34;"> xlwt</span><span style="color:#999999;">.</span><span style="color:#393A34;">easyxf</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">font: bold on</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">))</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 行，列</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 把爬取的内容写到 excel</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">excel_write</span><span style="color:#999999;">(</span><span style="color:#393A34;">content</span><span style="color:#999999;">,</span><span style="color:#393A34;"> index</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> i </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> content</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">        data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">        data</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">job_name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#393A34;">        data</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">company_name</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#393A34;">        salary </span><span style="color:#999999;">=</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">providesalary_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">providesalary_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">薪酬未知</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">        data</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">salary</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        data</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">workarea_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#393A34;">        treatment </span><span style="color:#999999;">=</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">jobwelf</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">jobwelf</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;&#39;</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">待遇未知</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">        data</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">treatment</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        require </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;&quot;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> item </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> i</span><span style="color:#999999;">[</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">attribute_text</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">]:</span></span>
<span class="line"><span style="color:#393A34;">          require </span><span style="color:#999999;">=</span><span style="color:#393A34;"> require  </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> item </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&#39;</span><span style="color:#A65E2B;">\\t</span><span style="color:#B5695999;">&#39;</span></span>
<span class="line"><span style="color:#393A34;">        data</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">require</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> i </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">0</span><span style="color:#999999;">,</span><span style="color:#2F798A;">6</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">            worksheet</span><span style="color:#999999;">.</span><span style="color:#393A34;">write</span><span style="color:#999999;">(</span><span style="color:#393A34;">index</span><span style="color:#999999;">,</span><span style="color:#393A34;"> i</span><span style="color:#999999;">,</span><span style="color:#393A34;"> data</span><span style="color:#999999;">[</span><span style="color:#393A34;">i</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#393A34;">        index</span><span style="color:#999999;">+=</span><span style="color:#2F798A;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">for</span><span style="color:#393A34;"> each </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#2F798A;">10</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    index </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">(</span><span style="color:#393A34;">each</span><span style="color:#AB5959;">-</span><span style="color:#2F798A;">1</span><span style="color:#999999;">)</span><span style="color:#AB5959;">*</span><span style="color:#2F798A;">50</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">+</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span></span>
<span class="line"><span style="color:#393A34;">    excel_write</span><span style="color:#999999;">(</span><span style="color:#393A34;">get</span><span style="color:#999999;">(</span><span style="color:#393A34;">get_content</span><span style="color:#999999;">(</span><span style="color:#393A34;">each</span><span style="color:#999999;">)),</span><span style="color:#393A34;"> index</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">workbook</span><span style="color:#999999;">.</span><span style="color:#393A34;">save</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">51job.xls</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span></code></pre></div><h3 id="爬取上面前程无忧的数据后、使用-pyecharts-xlrd-来实现可视化图表" tabindex="-1">爬取上面前程无忧的数据后、使用 pyecharts + xlrd 来实现可视化图表 <a class="header-anchor" href="#爬取上面前程无忧的数据后、使用-pyecharts-xlrd-来实现可视化图表" aria-label="Permalink to &quot;爬取上面前程无忧的数据后、使用 pyecharts + xlrd 来实现可视化图表&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki vitesse-dark vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> xlrd</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 读取文件</span></span>
<span class="line"><span style="color:#DBD7CAEE;">data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> xlrd</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">open_workbook</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#B8A965;">.</span><span style="color:#C4704F;">/51job</span><span style="color:#B8A965;">.</span><span style="color:#C4704F;">xls</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">table </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> data</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">sheets</span><span style="color:#666666;">()[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># table.nrows 多少行</span></span>
<span class="line"><span style="color:#758575DD;"># table.ncols 多少列</span></span>
<span class="line"><span style="color:#758575DD;"># 获取整行和整列的值</span></span>
<span class="line"><span style="color:#758575DD;"># table.row_values(1)</span></span>
<span class="line"><span style="color:#758575DD;"># table.col_values(2)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">salary_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">min_salary_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">max_salary_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">null_salary_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">salary</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">excel</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> index </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> excel</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">nrows</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 获取薪资待遇</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 0.8 - 1万 / 月</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        salary </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> excel</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">index</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">2</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">value</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        salary_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">salary</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 最低薪资</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        min_salary </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#666666;">)</span><span style="color:#C4704F;">-</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> salary</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        min_salary </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> min_salary</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">min_salary</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">薪酬未知</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        min_salary_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">min_salary</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> min_salary </span><span style="color:#CB7676;">!=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">薪酬未知</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> null_salary_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">min_salary</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 最高薪资</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        max_salary </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C4704F;">-</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#666666;">)</span><span style="color:#B8A965;">\\S</span><span style="color:#C4704F;">/</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> salary</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        max_salary </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> max_salary</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">max_salary</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">薪酬未知</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        max_salary_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">max_salary</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> max_salary </span><span style="color:#CB7676;">!=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">薪酬未知</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> null_salary_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">max_salary</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">experience_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">experience</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">excel</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> index </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> excel</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">nrows</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 获取 工作经验</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        experiences </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> excel</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">index</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">5</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">value</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        experience </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#B8A965;">\\s</span><span style="color:#666666;">(</span><span style="color:#B8A965;">.</span><span style="color:#CB7676;">*?</span><span style="color:#666666;">)</span><span style="color:#C4704F;">年经验</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> experiences</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        experience </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> experience</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">experience</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">and</span><span style="color:#DBD7CAEE;"> experience</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">!=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">无需</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;">  </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">0</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 取 最大工作经验</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        experience_min_max </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">(</span><span style="color:#B8A965;">\\d</span><span style="color:#666666;">)</span><span style="color:#C4704F;">-</span><span style="color:#666666;">(</span><span style="color:#B8A965;">\\d</span><span style="color:#666666;">)</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> experience</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        experience_average</span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">experience_min_max</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">0</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">int</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">experience_min_max</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">][</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">])</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        experience_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">experience_average</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">education_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">master_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 硕士</span></span>
<span class="line"><span style="color:#DBD7CAEE;">undergraduate_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 本科</span></span>
<span class="line"><span style="color:#DBD7CAEE;">specialty_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 专科</span></span>
<span class="line"><span style="color:#DBD7CAEE;">other_list </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[]</span><span style="color:#DBD7CAEE;">  </span><span style="color:#758575DD;"># 其他</span></span>
<span class="line"><span style="color:#CB7676;">def</span><span style="color:#DBD7CAEE;"> </span><span style="color:#80A665;">education</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">excel</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">    </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> index </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#4C9A91;">1</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> excel</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">nrows</span><span style="color:#666666;">):</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;"># 获取 学历</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        educations </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> excel</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">cell</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">index</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">5</span><span style="color:#666666;">).</span><span style="color:#DBD7CAEE;">value</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        education </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> re</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">findall</span><span style="color:#666666;">(</span><span style="color:#CB7676;">r</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#B8A965;">\\s</span><span style="color:#666666;">(</span><span style="color:#C4704F;">本科</span><span style="color:#CB7676;">|</span><span style="color:#C4704F;">大专</span><span style="color:#CB7676;">|</span><span style="color:#C4704F;">硕士</span><span style="color:#666666;">)</span><span style="color:#B8A965;">\\s</span><span style="color:#C4704F;">招</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> educations</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        education </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> education</span><span style="color:#666666;">[</span><span style="color:#4C9A91;">0</span><span style="color:#666666;">]</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">education</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4C9A91;">1</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">else</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">其他</span><span style="color:#C98A7D99;">&quot;</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        education_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">education</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CAEE;"> education </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">硕士</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            master_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">education</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">elif</span><span style="color:#DBD7CAEE;"> education </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">本科</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            undergraduate_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">education</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">elif</span><span style="color:#DBD7CAEE;"> education </span><span style="color:#CB7676;">==</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">大专</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            specialty_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">education</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#4D9375;">else</span><span style="color:#666666;">:</span></span>
<span class="line"><span style="color:#DBD7CAEE;">            other_list</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">append</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">education</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">salary</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">table</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">experience</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">table</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">education</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">table</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">#  450个Web开发部分岗位学历要求 饼图图表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> pyecharts </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> Pie</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;">Bar</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> Grid</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">attr </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">硕士</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">本科</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">大专</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">其他</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">education_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">master_list</span><span style="color:#666666;">),</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">undergraduate_list</span><span style="color:#666666;">),</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">specialty_list</span><span style="color:#666666;">),</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">other_list</span><span style="color:#666666;">)]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pie </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> Pie</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Web开发部分岗位学历要求</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">,</span><span style="color:#BD976A;">title_pos</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">center</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pie</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> attr</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> education_data</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">#radius=[35,75],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">is_label_show</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">,</span><span style="color:#758575DD;">#显示标签</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">legend_orient</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">vertical</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">legend_pos</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">right</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#图例设置为垂直排列，右侧</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pie</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">render</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Web开发部分岗位学历要求.html</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;">#  450个Web开发部分岗位学历要求 树状图图表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">attr </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">第</span><span style="color:#C99076;">{}</span><span style="color:#C98A7D;">个Web岗位</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">format</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> i </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">experience_list</span><span style="color:#666666;">))]</span></span>
<span class="line"><span style="color:#758575DD;"># v1 = [random.randint(1, 30) for _ in range(30)] #创建数据</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bar </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> Bar</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">450个Web岗位对应经验要求</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#BD976A;">title_pos</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">center</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span><span style="color:#758575DD;">#设置标题位置为center</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bar</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> attr</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> experience_list</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">is_label_show</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">is_datazoom_show</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#设置datazoom</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bar</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">render</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">450个Web岗位对应经验要求.html</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#758575DD;"># 上面两个图标 显示在一个页面</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> pyecharts </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> Bar</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> Pie</span></span>
<span class="line"><span style="color:#4D9375;">from</span><span style="color:#DBD7CAEE;"> pyecharts </span><span style="color:#4D9375;">import</span><span style="color:#DBD7CAEE;"> Page</span></span>
<span class="line"><span style="color:#DBD7CAEE;">page </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> Page</span><span style="color:#666666;">()</span></span>
<span class="line"><span style="color:#758575DD;"># bar</span></span>
<span class="line"><span style="color:#DBD7CAEE;">attr </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">第</span><span style="color:#C99076;">{}</span><span style="color:#C98A7D;">个Web岗位</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">format</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">i</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#4D9375;">for</span><span style="color:#DBD7CAEE;"> i </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">range</span><span style="color:#666666;">(</span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">experience_list</span><span style="color:#666666;">))]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bar </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> Bar</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">450个Web岗位对应经验要求</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#BD976A;">title_pos</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">center</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#758575DD;"># bar.use_theme(&quot;macarons&quot;)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">bar</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> attr</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> experience_list</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">is_label_show</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">is_datazoom_show</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">is_stack</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#设置datazoom</span></span>
<span class="line"><span style="color:#DBD7CAEE;">page</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">bar</span><span style="color:#666666;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CAEE;">attr </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">硕士</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">本科</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">大专</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">其他</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">education_data </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">[</span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">master_list</span><span style="color:#666666;">),</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">undergraduate_list</span><span style="color:#666666;">),</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">specialty_list</span><span style="color:#666666;">),</span><span style="color:#DBD7CAEE;"> </span><span style="color:#B8A965;">len</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">other_list</span><span style="color:#666666;">)]</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pie </span><span style="color:#666666;">=</span><span style="color:#DBD7CAEE;"> Pie</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">Web开发部分岗位学历要求</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#DBD7CAEE;"> </span><span style="color:#666666;">,</span><span style="color:#BD976A;">title_pos</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">center</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">pie</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&quot;&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> attr</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> education_data</span><span style="color:#666666;">,</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#758575DD;">#radius=[35,75],</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">is_label_show</span><span style="color:#666666;">=</span><span style="color:#4D9375;">True</span><span style="color:#666666;">,</span><span style="color:#758575DD;">#显示标签</span></span>
<span class="line"><span style="color:#DBD7CAEE;">        </span><span style="color:#BD976A;">legend_orient</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">vertical</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">,</span><span style="color:#DBD7CAEE;"> </span><span style="color:#BD976A;">legend_pos</span><span style="color:#666666;">=</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#C98A7D;">right</span><span style="color:#C98A7D99;">&quot;</span><span style="color:#666666;">)</span><span style="color:#DBD7CAEE;"> </span><span style="color:#758575DD;">#图例设置为垂直排列，右侧</span></span>
<span class="line"><span style="color:#DBD7CAEE;">page</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">add</span><span style="color:#666666;">(</span><span style="color:#DBD7CAEE;">pie</span><span style="color:#666666;">)</span></span>
<span class="line"><span style="color:#DBD7CAEE;">page</span><span style="color:#666666;">.</span><span style="color:#DBD7CAEE;">render</span><span style="color:#666666;">(</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#C98A7D;">Web开发部分岗位学历要求.html</span><span style="color:#C98A7D99;">&#39;</span><span style="color:#666666;">)</span></span></code></pre><pre class="shiki vitesse-light vp-code-light"><code><span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> xlrd</span></span>
<span class="line"><span style="color:#1E754F;">import</span><span style="color:#393A34;"> re</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 读取文件</span></span>
<span class="line"><span style="color:#393A34;">data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> xlrd</span><span style="color:#999999;">.</span><span style="color:#393A34;">open_workbook</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#998418;">.</span><span style="color:#AB5E3F;">/51job</span><span style="color:#998418;">.</span><span style="color:#AB5E3F;">xls</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">table </span><span style="color:#999999;">=</span><span style="color:#393A34;"> data</span><span style="color:#999999;">.</span><span style="color:#393A34;">sheets</span><span style="color:#999999;">()[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># table.nrows 多少行</span></span>
<span class="line"><span style="color:#A0ADA0;"># table.ncols 多少列</span></span>
<span class="line"><span style="color:#A0ADA0;"># 获取整行和整列的值</span></span>
<span class="line"><span style="color:#A0ADA0;"># table.row_values(1)</span></span>
<span class="line"><span style="color:#A0ADA0;"># table.col_values(2)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">salary_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">min_salary_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">max_salary_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">null_salary_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">salary</span><span style="color:#999999;">(</span><span style="color:#393A34;">excel</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> index </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#393A34;"> excel</span><span style="color:#999999;">.</span><span style="color:#393A34;">nrows</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 获取薪资待遇</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 0.8 - 1万 / 月</span></span>
<span class="line"><span style="color:#393A34;">        salary </span><span style="color:#999999;">=</span><span style="color:#393A34;"> excel</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell</span><span style="color:#999999;">(</span><span style="color:#393A34;">index</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">2</span><span style="color:#999999;">).</span><span style="color:#393A34;">value</span></span>
<span class="line"><span style="color:#393A34;">        salary_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">salary</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 最低薪资</span></span>
<span class="line"><span style="color:#393A34;">        min_salary </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">-</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> salary</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        min_salary </span><span style="color:#999999;">=</span><span style="color:#393A34;"> min_salary</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">min_salary</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">薪酬未知</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">        min_salary_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">min_salary</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> min_salary </span><span style="color:#AB5959;">!=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">薪酬未知</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> null_salary_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">min_salary</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 最高薪资</span></span>
<span class="line"><span style="color:#393A34;">        max_salary </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#AB5E3F;">-</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#999999;">)</span><span style="color:#998418;">\\S</span><span style="color:#AB5E3F;">/</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> salary</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        max_salary </span><span style="color:#999999;">=</span><span style="color:#393A34;"> max_salary</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">max_salary</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">薪酬未知</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">        max_salary_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">max_salary</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> max_salary </span><span style="color:#AB5959;">!=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">薪酬未知</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> null_salary_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">max_salary</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">experience_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">experience</span><span style="color:#999999;">(</span><span style="color:#393A34;">excel</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> index </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#393A34;"> excel</span><span style="color:#999999;">.</span><span style="color:#393A34;">nrows</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 获取 工作经验</span></span>
<span class="line"><span style="color:#393A34;">        experiences </span><span style="color:#999999;">=</span><span style="color:#393A34;"> excel</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell</span><span style="color:#999999;">(</span><span style="color:#393A34;">index</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">5</span><span style="color:#999999;">).</span><span style="color:#393A34;">value</span></span>
<span class="line"><span style="color:#393A34;">        experience </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#998418;">\\s</span><span style="color:#999999;">(</span><span style="color:#998418;">.</span><span style="color:#AB5959;">*?</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">年经验</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> experiences</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        experience </span><span style="color:#999999;">=</span><span style="color:#393A34;"> experience</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">experience</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">and</span><span style="color:#393A34;"> experience</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">!=</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">无需</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;">  </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">0</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 取 最大工作经验</span></span>
<span class="line"><span style="color:#393A34;">        experience_min_max </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">(</span><span style="color:#998418;">\\d</span><span style="color:#999999;">)</span><span style="color:#AB5E3F;">-</span><span style="color:#999999;">(</span><span style="color:#998418;">\\d</span><span style="color:#999999;">)</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> experience</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        experience_average</span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">experience_min_max</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">0</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#998418;">int</span><span style="color:#999999;">(</span><span style="color:#393A34;">experience_min_max</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">][</span><span style="color:#2F798A;">1</span><span style="color:#999999;">])</span></span>
<span class="line"><span style="color:#393A34;">        experience_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">experience_average</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">education_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span></span>
<span class="line"><span style="color:#393A34;">master_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 硕士</span></span>
<span class="line"><span style="color:#393A34;">undergraduate_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 本科</span></span>
<span class="line"><span style="color:#393A34;">specialty_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 专科</span></span>
<span class="line"><span style="color:#393A34;">other_list </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[]</span><span style="color:#393A34;">  </span><span style="color:#A0ADA0;"># 其他</span></span>
<span class="line"><span style="color:#AB5959;">def</span><span style="color:#393A34;"> </span><span style="color:#59873A;">education</span><span style="color:#999999;">(</span><span style="color:#393A34;">excel</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> index </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#2F798A;">1</span><span style="color:#999999;">,</span><span style="color:#393A34;"> excel</span><span style="color:#999999;">.</span><span style="color:#393A34;">nrows</span><span style="color:#999999;">):</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># 获取 学历</span></span>
<span class="line"><span style="color:#393A34;">        educations </span><span style="color:#999999;">=</span><span style="color:#393A34;"> excel</span><span style="color:#999999;">.</span><span style="color:#393A34;">cell</span><span style="color:#999999;">(</span><span style="color:#393A34;">index</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">5</span><span style="color:#999999;">).</span><span style="color:#393A34;">value</span></span>
<span class="line"><span style="color:#393A34;">        education </span><span style="color:#999999;">=</span><span style="color:#393A34;"> re</span><span style="color:#999999;">.</span><span style="color:#393A34;">findall</span><span style="color:#999999;">(</span><span style="color:#AB5959;">r</span><span style="color:#B5695999;">&#39;</span><span style="color:#998418;">\\s</span><span style="color:#999999;">(</span><span style="color:#AB5E3F;">本科</span><span style="color:#AB5959;">|</span><span style="color:#AB5E3F;">大专</span><span style="color:#AB5959;">|</span><span style="color:#AB5E3F;">硕士</span><span style="color:#999999;">)</span><span style="color:#998418;">\\s</span><span style="color:#AB5E3F;">招</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> educations</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        education </span><span style="color:#999999;">=</span><span style="color:#393A34;"> education</span><span style="color:#999999;">[</span><span style="color:#2F798A;">0</span><span style="color:#999999;">]</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">education</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#2F798A;">1</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">else</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">其他</span><span style="color:#B5695999;">&quot;</span></span>
<span class="line"><span style="color:#393A34;">        education_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">education</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">if</span><span style="color:#393A34;"> education </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">硕士</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            master_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">education</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">elif</span><span style="color:#393A34;"> education </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">本科</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            undergraduate_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">education</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">elif</span><span style="color:#393A34;"> education </span><span style="color:#AB5959;">==</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">大专</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            specialty_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">education</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#1E754F;">else</span><span style="color:#999999;">:</span></span>
<span class="line"><span style="color:#393A34;">            other_list</span><span style="color:#999999;">.</span><span style="color:#393A34;">append</span><span style="color:#999999;">(</span><span style="color:#393A34;">education</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">salary</span><span style="color:#999999;">(</span><span style="color:#393A34;">table</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">experience</span><span style="color:#999999;">(</span><span style="color:#393A34;">table</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">education</span><span style="color:#999999;">(</span><span style="color:#393A34;">table</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">#  450个Web开发部分岗位学历要求 饼图图表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> pyecharts </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> Pie</span><span style="color:#999999;">,</span><span style="color:#393A34;">Bar</span><span style="color:#999999;">,</span><span style="color:#393A34;"> Grid</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">attr </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">硕士</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">本科</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">大专</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">其他</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">education_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">master_list</span><span style="color:#999999;">),</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">undergraduate_list</span><span style="color:#999999;">),</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">specialty_list</span><span style="color:#999999;">),</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">other_list</span><span style="color:#999999;">)]</span></span>
<span class="line"><span style="color:#393A34;">pie </span><span style="color:#999999;">=</span><span style="color:#393A34;"> Pie</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Web开发部分岗位学历要求</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">,</span><span style="color:#B07D48;">title_pos</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">center</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">pie</span><span style="color:#999999;">.</span><span style="color:#393A34;">add</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> attr</span><span style="color:#999999;">,</span><span style="color:#393A34;"> education_data</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">#radius=[35,75],</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">is_label_show</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">,</span><span style="color:#A0ADA0;">#显示标签</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">legend_orient</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">vertical</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">legend_pos</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">right</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#图例设置为垂直排列，右侧</span></span>
<span class="line"><span style="color:#393A34;">pie</span><span style="color:#999999;">.</span><span style="color:#393A34;">render</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Web开发部分岗位学历要求.html</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">#  450个Web开发部分岗位学历要求 树状图图表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">attr </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">第</span><span style="color:#A65E2B;">{}</span><span style="color:#B56959;">个Web岗位</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">.</span><span style="color:#393A34;">format</span><span style="color:#999999;">(</span><span style="color:#393A34;">i</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> i </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">experience_list</span><span style="color:#999999;">))]</span></span>
<span class="line"><span style="color:#A0ADA0;"># v1 = [random.randint(1, 30) for _ in range(30)] #创建数据</span></span>
<span class="line"><span style="color:#393A34;">bar </span><span style="color:#999999;">=</span><span style="color:#393A34;"> Bar</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">450个Web岗位对应经验要求</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#B07D48;">title_pos</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">center</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span><span style="color:#A0ADA0;">#设置标题位置为center</span></span>
<span class="line"><span style="color:#393A34;">bar</span><span style="color:#999999;">.</span><span style="color:#393A34;">add</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> attr</span><span style="color:#999999;">,</span><span style="color:#393A34;"> experience_list</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">is_label_show</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">is_datazoom_show</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#设置datazoom</span></span>
<span class="line"><span style="color:#393A34;">bar</span><span style="color:#999999;">.</span><span style="color:#393A34;">render</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">450个Web岗位对应经验要求.html</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># 上面两个图标 显示在一个页面</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> pyecharts </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> Bar</span><span style="color:#999999;">,</span><span style="color:#393A34;"> Pie</span></span>
<span class="line"><span style="color:#1E754F;">from</span><span style="color:#393A34;"> pyecharts </span><span style="color:#1E754F;">import</span><span style="color:#393A34;"> Page</span></span>
<span class="line"><span style="color:#393A34;">page </span><span style="color:#999999;">=</span><span style="color:#393A34;"> Page</span><span style="color:#999999;">()</span></span>
<span class="line"><span style="color:#A0ADA0;"># bar</span></span>
<span class="line"><span style="color:#393A34;">attr </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">第</span><span style="color:#A65E2B;">{}</span><span style="color:#B56959;">个Web岗位</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">.</span><span style="color:#393A34;">format</span><span style="color:#999999;">(</span><span style="color:#393A34;">i</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#1E754F;">for</span><span style="color:#393A34;"> i </span><span style="color:#1E754F;">in</span><span style="color:#393A34;"> </span><span style="color:#998418;">range</span><span style="color:#999999;">(</span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">experience_list</span><span style="color:#999999;">))]</span></span>
<span class="line"><span style="color:#393A34;">bar </span><span style="color:#999999;">=</span><span style="color:#393A34;"> Bar</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">450个Web岗位对应经验要求</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#B07D48;">title_pos</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">center</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># bar.use_theme(&quot;macarons&quot;)</span></span>
<span class="line"><span style="color:#393A34;">bar</span><span style="color:#999999;">.</span><span style="color:#393A34;">add</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> attr</span><span style="color:#999999;">,</span><span style="color:#393A34;"> experience_list</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">is_label_show</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">is_datazoom_show</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">is_stack</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#设置datazoom</span></span>
<span class="line"><span style="color:#393A34;">page</span><span style="color:#999999;">.</span><span style="color:#393A34;">add</span><span style="color:#999999;">(</span><span style="color:#393A34;">bar</span><span style="color:#999999;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">attr </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">硕士</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">本科</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">大专</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">其他</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">]</span></span>
<span class="line"><span style="color:#393A34;">education_data </span><span style="color:#999999;">=</span><span style="color:#393A34;"> </span><span style="color:#999999;">[</span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">master_list</span><span style="color:#999999;">),</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">undergraduate_list</span><span style="color:#999999;">),</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">specialty_list</span><span style="color:#999999;">),</span><span style="color:#393A34;"> </span><span style="color:#998418;">len</span><span style="color:#999999;">(</span><span style="color:#393A34;">other_list</span><span style="color:#999999;">)]</span></span>
<span class="line"><span style="color:#393A34;">pie </span><span style="color:#999999;">=</span><span style="color:#393A34;"> Pie</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">Web开发部分岗位学历要求</span><span style="color:#B5695999;">&quot;</span><span style="color:#393A34;"> </span><span style="color:#999999;">,</span><span style="color:#B07D48;">title_pos</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">center</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">pie</span><span style="color:#999999;">.</span><span style="color:#393A34;">add</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&quot;&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> attr</span><span style="color:#999999;">,</span><span style="color:#393A34;"> education_data</span><span style="color:#999999;">,</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#A0ADA0;">#radius=[35,75],</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">is_label_show</span><span style="color:#999999;">=</span><span style="color:#1E754F;">True</span><span style="color:#999999;">,</span><span style="color:#A0ADA0;">#显示标签</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B07D48;">legend_orient</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">vertical</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">,</span><span style="color:#393A34;"> </span><span style="color:#B07D48;">legend_pos</span><span style="color:#999999;">=</span><span style="color:#B5695999;">&quot;</span><span style="color:#B56959;">right</span><span style="color:#B5695999;">&quot;</span><span style="color:#999999;">)</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">#图例设置为垂直排列，右侧</span></span>
<span class="line"><span style="color:#393A34;">page</span><span style="color:#999999;">.</span><span style="color:#393A34;">add</span><span style="color:#999999;">(</span><span style="color:#393A34;">pie</span><span style="color:#999999;">)</span></span>
<span class="line"><span style="color:#393A34;">page</span><span style="color:#999999;">.</span><span style="color:#393A34;">render</span><span style="color:#999999;">(</span><span style="color:#B5695999;">&#39;</span><span style="color:#B56959;">Web开发部分岗位学历要求.html</span><span style="color:#B5695999;">&#39;</span><span style="color:#999999;">)</span></span></code></pre></div>`,137),e=[o];function t(c,r,y,A,D,i){return a(),n("div",null,e)}const C=s(p,[["render",t]]);export{B as __pageData,C as default};
